<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>gci: /__w/gci/gci/src/molpro/symmetry_matrix/Operator-implementation.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">gci
   &#160;<span id="projectnumber">.</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3a0534501ca4be4079425efd3c8ffab8.html">__w</a></li><li class="navelem"><a class="el" href="dir_65d742138b8b793e957ab942ceaff73a.html">gci</a></li><li class="navelem"><a class="el" href="dir_3d7c9760e3206c2c7f82e221e6e9f123.html">gci</a></li><li class="navelem"><a class="el" href="dir_e2a68103f45c0ff39b8fe649fd6c83bf.html">src</a></li><li class="navelem"><a class="el" href="dir_4f3b60eecda8f0139063ac4c02da5887.html">molpro</a></li><li class="navelem"><a class="el" href="dir_2ea3f7c3e1e71692ee8649748352609e.html">symmetry_matrix</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Operator-implementation.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Operator-implementation_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef SYMMETRY_MATRIX_OPERATOR_IMPLEMENTATION_H</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define SYMMETRY_MATRIX_OPERATOR_IMPLEMENTATION_H</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="Operator_8h.html">molpro/symmetry_matrix/Operator.h</a>&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160; </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacemolpro.html">molpro</a>;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno"><a class="line" href="Operator-implementation_8h.html#a16b1d5bff65e7d8d50aca34740df0dd9">    8</a></span>&#160;<span class="keyword">inline</span> <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6f">parity_t</a> <a class="code" href="Operator-implementation_8h.html#a16b1d5bff65e7d8d50aca34740df0dd9">parity</a>(<span class="keywordtype">int</span> hermiticity, <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6f">parity_t</a> odd = <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fadf9df807b4f5e704d4dd447772943798">parityOddPacked</a>) {</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  <span class="keywordflow">if</span> (hermiticity == 0)</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fab84d144528f1a54d906ec2d9922f3aec">parityNone</a>;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="keywordflow">if</span> (hermiticity &gt; 0)</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fa09ceea7356628ff7d1cbc1d0149544e7">parityEven</a>;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="keywordflow">return</span> odd;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;}</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#ad7405980136ba27e76d96d4ef9046a88">   17</a></span>&#160;<a class="code" href="classmolpro_1_1Operator__.html#ad7405980136ba27e76d96d4ef9046a88">Operator_&lt;T&gt;::Operator_</a>(std::array&lt;dims_t, 2&gt; dimensions, <span class="keywordtype">int</span> rank, <span class="keywordtype">bool</span> uhf, std::vector&lt;int&gt; hermiticity,</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                        std::vector&lt;int&gt; exchange, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> symmetry, <span class="keywordtype">bool</span> covariant, <span class="keywordtype">bool</span> diagonal,</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;                        std::string description)</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    : m_dimensions(std::move(dimensions)), m_rank(std::move(rank)), m_uhf(std::move(uhf)),</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;      m_hermiticity(std::move(hermiticity)), m_exchange(std::move(exchange)), m_symmetry(std::move(symmetry)),</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;      m_description(std::move(description)), m_O0(0), m_covariant(covariant), m_diagonal(diagonal),</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;      m_dirac_out_of_date(true) {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordflow">if</span> (m_dimensions.size() != 2)</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">throw</span> std::logic_error(<span class="stringliteral">&quot;dimensions must be dimensioned 2&quot;</span>);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">if</span> (<span class="keywordtype">int</span>(m_dimensions[0].size()) &lt; <a class="code" href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">m_rank</a> * 2)</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordflow">throw</span> std::logic_error(<span class="stringliteral">&quot;dimensions must be dimensioned at least rank*2&quot;</span>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">if</span> (<span class="keywordtype">int</span>(m_dimensions[1].size()) &lt; <a class="code" href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">m_rank</a> * 2)</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordflow">throw</span> std::logic_error(<span class="stringliteral">&quot;dimensions must be dimensioned at least rank*2&quot;</span>);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">m_rank</a> &gt; 1 &amp;&amp; <a class="code" href="classmolpro_1_1Operator__.html#a56ee0078a62b241588913b717ca60178">m_hermiticity</a>.size() != 2)</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">throw</span> std::logic_error(<span class="stringliteral">&quot;hermiticity must be dimensioned 2&quot;</span>);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">if</span> (<span class="keywordtype">int</span>(<a class="code" href="classmolpro_1_1Operator__.html#ab1be924f24f25900aad356f0309d9f1a">m_exchange</a>.size()) &lt; (<a class="code" href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">m_rank</a> - 1) * 2)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">throw</span> std::logic_error(<span class="stringliteral">&quot;exchange must be dimensioned at least 2&quot;</span>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a>* dummyBuffer = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">m_rank</a> == 1 || (<a class="code" href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">m_rank</a> == 2 &amp;&amp; <a class="code" href="classmolpro_1_1Operator__.html#a56ee0078a62b241588913b717ca60178">m_hermiticity</a>[0] == <a class="code" href="classmolpro_1_1Operator__.html#a56ee0078a62b241588913b717ca60178">m_hermiticity</a>[1])) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="classmolpro_1_1Operator__.html#a468d6e8eb978198531c2c90776f9ebaa">m_O1a</a> = std::make_shared&lt;SMat_&lt;T&gt;&gt;(<a class="code" href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">dims_t</a>{m_dimensions[0][0], m_dimensions[0][1]},</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                                       <a class="code" href="Operator-implementation_8h.html#a16b1d5bff65e7d8d50aca34740df0dd9">parity</a>(<a class="code" href="classmolpro_1_1Operator__.html#a56ee0078a62b241588913b717ca60178">m_hermiticity</a>[0] * (rank &lt; 2 ? 1 : <a class="code" href="classmolpro_1_1Operator__.html#a56ee0078a62b241588913b717ca60178">m_hermiticity</a>[1]), <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fa5d5c6a3594b6f312d3d19b349ca8d25e">parityOdd</a>),</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                                       <a class="code" href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">m_symmetry</a>, <a class="code" href="classmolpro_1_1Operator__.html#a27ae8bd941dc27e01dc7942ee1944610">m_diagonal</a>, <a class="code" href="classmolpro_1_1Operator__.html#a0ce4e4cf159d614704523aecf94e70d4">m_description</a> + (<a class="code" href="classmolpro_1_1Operator__.html#addb215888a5251d81aba6db8f9926b3f">m_uhf</a> ? <span class="stringliteral">&quot;:a&quot;</span> : <span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="classmolpro_1_1Operator__.html#aa19f592a7a1eb89168d50f8e92b85160">m_O1b</a> = <a class="code" href="classmolpro_1_1Operator__.html#addb215888a5251d81aba6db8f9926b3f">m_uhf</a> ? std::make_shared&lt;SMat_&lt;T&gt;&gt;(<a class="code" href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">dims_t</a>{m_dimensions[1][0], m_dimensions[1][1]},</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                                               <a class="code" href="Operator-implementation_8h.html#a16b1d5bff65e7d8d50aca34740df0dd9">parity</a>(<a class="code" href="classmolpro_1_1Operator__.html#a56ee0078a62b241588913b717ca60178">m_hermiticity</a>[0] * (rank &lt; 2 ? 1 : <a class="code" href="classmolpro_1_1Operator__.html#a56ee0078a62b241588913b717ca60178">m_hermiticity</a>[1]), <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fa5d5c6a3594b6f312d3d19b349ca8d25e">parityOdd</a>),</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                               <a class="code" href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">m_symmetry</a>, <span class="keyword">false</span>, <a class="code" href="classmolpro_1_1Operator__.html#a0ce4e4cf159d614704523aecf94e70d4">m_description</a> + <span class="stringliteral">&quot;:b&quot;</span>)</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                  : <a class="code" href="classmolpro_1_1Operator__.html#a468d6e8eb978198531c2c90776f9ebaa">m_O1a</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">m_rank</a> == 2) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <a class="code" href="classmolpro_1_1SMat__.html">SMat_&lt;T&gt;</a> innera(<a class="code" href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">dims_t</a>{m_dimensions[0][0], m_dimensions[0][1]}, dummyBuffer, <a class="code" href="Operator-implementation_8h.html#a16b1d5bff65e7d8d50aca34740df0dd9">parity</a>(<a class="code" href="classmolpro_1_1Operator__.html#a56ee0078a62b241588913b717ca60178">m_hermiticity</a>[0]), 0, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                      <a class="code" href="classmolpro_1_1Operator__.html#a0ce4e4cf159d614704523aecf94e70d4">m_description</a> + (<a class="code" href="classmolpro_1_1Operator__.html#addb215888a5251d81aba6db8f9926b3f">m_uhf</a> ? <span class="stringliteral">&quot;:maa&quot;</span> : <span class="stringliteral">&quot;m&quot;</span>));</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <a class="code" href="classmolpro_1_1SMat__.html">SMat_&lt;T&gt;</a> innerb(<a class="code" href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">dims_t</a>{m_dimensions[1][0], m_dimensions[1][1]}, dummyBuffer, <a class="code" href="Operator-implementation_8h.html#a16b1d5bff65e7d8d50aca34740df0dd9">parity</a>(<a class="code" href="classmolpro_1_1Operator__.html#a56ee0078a62b241588913b717ca60178">m_hermiticity</a>[0]), 0, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                      <a class="code" href="classmolpro_1_1Operator__.html#a0ce4e4cf159d614704523aecf94e70d4">m_description</a> + (<a class="code" href="classmolpro_1_1Operator__.html#addb215888a5251d81aba6db8f9926b3f">m_uhf</a> ? <span class="stringliteral">&quot;:mbb&quot;</span> : <span class="stringliteral">&quot;m&quot;</span>));</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="comment">//      std::cout &lt;&lt; &quot;memory_remaining()=&quot;&lt;&lt;memory_remaining()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <a class="code" href="classmolpro_1_1Operator__.html#ada91d58116a902824c0db68affb93c53">m_O2aa_mulliken</a> = std::make_shared&lt;SMatMat_&lt;SMat_&lt;T&gt;&gt;&gt;(innera, <a class="code" href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">dims_t</a>{m_dimensions[0][2], m_dimensions[0][3]},</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                                             <span class="keyword">nullptr</span>, <a class="code" href="Operator-implementation_8h.html#a16b1d5bff65e7d8d50aca34740df0dd9">parity</a>(<a class="code" href="classmolpro_1_1Operator__.html#a56ee0078a62b241588913b717ca60178">m_hermiticity</a>[1]), <a class="code" href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">m_symmetry</a>,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                                             <a class="code" href="classmolpro_1_1Operator__.html#a0ce4e4cf159d614704523aecf94e70d4">m_description</a> + (<a class="code" href="classmolpro_1_1Operator__.html#addb215888a5251d81aba6db8f9926b3f">m_uhf</a> ? <span class="stringliteral">&quot;:maa&quot;</span> : <span class="stringliteral">&quot;:m&quot;</span>));</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="comment">//      std::cout &lt;&lt; &quot;O2aa_mulliken created at &quot;&lt;&lt;&amp;m_O2aa_mulliken-&gt;block(0)[0]&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="comment">//      std::cout &lt;&lt; &quot;memory_remaining()=&quot;&lt;&lt;memory_remaining()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmolpro_1_1Operator__.html#addb215888a5251d81aba6db8f9926b3f">m_uhf</a>) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <a class="code" href="classmolpro_1_1Operator__.html#ac507cb97c4b761359154c2cafc71038f">m_O2ab_mulliken</a> =</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            std::make_shared&lt;SMatMat_&lt;SMat_&lt;T&gt;&gt;&gt;(innera, <a class="code" href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">dims_t</a>{m_dimensions[1][2], m_dimensions[1][3]}, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                                 <a class="code" href="Operator-implementation_8h.html#a16b1d5bff65e7d8d50aca34740df0dd9">parity</a>(<a class="code" href="classmolpro_1_1Operator__.html#a56ee0078a62b241588913b717ca60178">m_hermiticity</a>[1]), <a class="code" href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">m_symmetry</a>, <a class="code" href="classmolpro_1_1Operator__.html#a0ce4e4cf159d614704523aecf94e70d4">m_description</a> + <span class="stringliteral">&quot;:mab&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classmolpro_1_1Operator__.html#ab1be924f24f25900aad356f0309d9f1a">m_exchange</a>[0] * <a class="code" href="classmolpro_1_1Operator__.html#ab1be924f24f25900aad356f0309d9f1a">m_exchange</a>[1] == 0)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;          <a class="code" href="classmolpro_1_1Operator__.html#ab273295fddb11078d804f227af7a512d">m_O2ba_mulliken</a> =</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;              std::make_shared&lt;SMatMat_&lt;SMat_&lt;T&gt;&gt;&gt;(innerb, <a class="code" href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">dims_t</a>{m_dimensions[0][2], m_dimensions[0][3]}, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                                                   <a class="code" href="Operator-implementation_8h.html#a16b1d5bff65e7d8d50aca34740df0dd9">parity</a>(<a class="code" href="classmolpro_1_1Operator__.html#a56ee0078a62b241588913b717ca60178">m_hermiticity</a>[1]), <a class="code" href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">m_symmetry</a>, <a class="code" href="classmolpro_1_1Operator__.html#a0ce4e4cf159d614704523aecf94e70d4">m_description</a> + <span class="stringliteral">&quot;:mba&quot;</span>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="classmolpro_1_1Operator__.html#a036e2e9bc406cf44c59af8a6580898b7">m_O2bb_mulliken</a> =</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            std::make_shared&lt;SMatMat_&lt;SMat_&lt;T&gt;&gt;&gt;(innerb, <a class="code" href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">dims_t</a>{m_dimensions[1][2], m_dimensions[1][3]}, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                                 <a class="code" href="Operator-implementation_8h.html#a16b1d5bff65e7d8d50aca34740df0dd9">parity</a>(<a class="code" href="classmolpro_1_1Operator__.html#a56ee0078a62b241588913b717ca60178">m_hermiticity</a>[1]), <a class="code" href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">m_symmetry</a>, <a class="code" href="classmolpro_1_1Operator__.html#a0ce4e4cf159d614704523aecf94e70d4">m_description</a> + <span class="stringliteral">&quot;:mbb&quot;</span>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="comment">//            std::cout &lt;&lt; &quot;UHF Operator_&lt;T&gt; load &quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <a class="code" href="classmolpro_1_1Operator__.html#ac507cb97c4b761359154c2cafc71038f">m_O2ab_mulliken</a> = <a class="code" href="classmolpro_1_1Operator__.html#ab273295fddb11078d804f227af7a512d">m_O2ba_mulliken</a> = <a class="code" href="classmolpro_1_1Operator__.html#a036e2e9bc406cf44c59af8a6580898b7">m_O2bb_mulliken</a> = <a class="code" href="classmolpro_1_1Operator__.html#ada91d58116a902824c0db68affb93c53">m_O2aa_mulliken</a>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="comment">//            std::cout &lt;&lt; &quot;RHF Operator_&lt;T&gt; load &quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="comment">//            std::cout &lt;&lt; m_O2aa_mulliken &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="comment">//            std::cout &lt;&lt; m_O2ab_mulliken &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <a class="code" href="classmolpro_1_1SMat__.html">SMat_&lt;T&gt;</a> innera(<a class="code" href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">dims_t</a>{m_dimensions[0][0], m_dimensions[0][2]}, dummyBuffer, <a class="code" href="Operator-implementation_8h.html#a16b1d5bff65e7d8d50aca34740df0dd9">parity</a>(<a class="code" href="classmolpro_1_1Operator__.html#ab1be924f24f25900aad356f0309d9f1a">m_exchange</a>[0]), 0, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                      <a class="code" href="classmolpro_1_1Operator__.html#a0ce4e4cf159d614704523aecf94e70d4">m_description</a> + <span class="stringliteral">&quot;:daa&quot;</span>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <a class="code" href="classmolpro_1_1SMat__.html">SMat_&lt;T&gt;</a> innerb(<a class="code" href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">dims_t</a>{m_dimensions[1][0], m_dimensions[1][2]}, dummyBuffer, <a class="code" href="Operator-implementation_8h.html#a16b1d5bff65e7d8d50aca34740df0dd9">parity</a>(<a class="code" href="classmolpro_1_1Operator__.html#ab1be924f24f25900aad356f0309d9f1a">m_exchange</a>[0]), 0, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#ad7405980136ba27e76d96d4ef9046a88">   79</a></span>&#160;                      <a class="code" href="classmolpro_1_1Operator__.html#a0ce4e4cf159d614704523aecf94e70d4">m_description</a> + <span class="stringliteral">&quot;:dbb&quot;</span>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="comment">//        std::cout &lt;&lt; &quot;inner parity=&quot;&lt;&lt;inner.parity()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="comment">//        std::cout &lt;&lt; &quot;O2aa_mulliken at &quot;&lt;&lt;&amp;m_O2aa_mulliken-&gt;block(0)[0]&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="comment">//        std::cout &lt;&lt; &quot;memory_remaining()=&quot;&lt;&lt;memory_remaining()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <a class="code" href="classmolpro_1_1Operator__.html#a4a1560a5764ad1454f9557ff369372b5">m_O2aa_dirac</a> = std::make_shared&lt;SMatMat_&lt;SMat_&lt;T&gt;&gt;&gt;(</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;          innera, <a class="code" href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">dims_t</a>{m_dimensions[0][1], m_dimensions[0][3]}, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;          (<a class="code" href="classmolpro_1_1Operator__.html#ab1be924f24f25900aad356f0309d9f1a">m_exchange</a>[1] ? (<a class="code" href="classmolpro_1_1Operator__.html#ab1be924f24f25900aad356f0309d9f1a">m_exchange</a>[1] &gt; 0 ? <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fa09ceea7356628ff7d1cbc1d0149544e7">parityEven</a> : <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fadf9df807b4f5e704d4dd447772943798">parityOddPacked</a>) : <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fab84d144528f1a54d906ec2d9922f3aec">parityNone</a>), <a class="code" href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">m_symmetry</a>,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;          <a class="code" href="classmolpro_1_1Operator__.html#a0ce4e4cf159d614704523aecf94e70d4">m_description</a> + <span class="stringliteral">&quot;:daa&quot;</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="comment">//        std::cout &lt;&lt; &quot;O2aa_dirac created at &quot;&lt;&lt;&amp;m_O2aa_dirac-&gt;block(0)[0]&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="comment">//        std::cout &lt;&lt; &quot;memory_remaining()=&quot;&lt;&lt;memory_remaining()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <a class="code" href="classmolpro_1_1SMat__.html">SMat_&lt;T&gt;</a> inner2(<a class="code" href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">dims_t</a>{m_dimensions[0][0], m_dimensions[1][2]}, dummyBuffer, <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fab84d144528f1a54d906ec2d9922f3aec">parityNone</a>, 0, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                      <a class="code" href="classmolpro_1_1Operator__.html#a0ce4e4cf159d614704523aecf94e70d4">m_description</a> + <span class="stringliteral">&quot;:dab&quot;</span>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="comment">//        std::cout &lt;&lt; &quot;inner2 parity=&quot;&lt;&lt;inner2.parity()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <a class="code" href="classmolpro_1_1Operator__.html#aac42e52c476f29ff1179fd9be789111f">m_O2ab_dirac</a> = std::make_shared&lt;SMatMat_&lt;SMat_&lt;T&gt;&gt;&gt;(inner2, <a class="code" href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">dims_t</a>{m_dimensions[0][1], m_dimensions[1][3]},</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                                                          <span class="keyword">nullptr</span>, <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fab84d144528f1a54d906ec2d9922f3aec">parityNone</a>, <a class="code" href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">m_symmetry</a>, <a class="code" href="classmolpro_1_1Operator__.html#a0ce4e4cf159d614704523aecf94e70d4">m_description</a> + <span class="stringliteral">&quot;:dab&quot;</span>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="comment">//        std::cout &lt;&lt; &quot;O2ab_dirac created at &quot;&lt;&lt;&amp;m_O2ab_dirac-&gt;block(0)[0]&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="comment">//        std::cout &lt;&lt; &quot;memory_remaining()=&quot;&lt;&lt;memory_remaining()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmolpro_1_1Operator__.html#addb215888a5251d81aba6db8f9926b3f">m_uhf</a>) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <a class="code" href="classmolpro_1_1Operator__.html#aa1233fe514f2df7e486ff86afc8ac0a7">m_O2bb_dirac</a> = std::make_shared&lt;SMatMat_&lt;SMat_&lt;T&gt;&gt;&gt;(</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            innerb, <a class="code" href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">dims_t</a>{m_dimensions[1][1], m_dimensions[1][3]}, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            (<a class="code" href="classmolpro_1_1Operator__.html#ab1be924f24f25900aad356f0309d9f1a">m_exchange</a>[1] ? (<a class="code" href="classmolpro_1_1Operator__.html#ab1be924f24f25900aad356f0309d9f1a">m_exchange</a>[1] &gt; 0 ? <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fa09ceea7356628ff7d1cbc1d0149544e7">parityEven</a> : <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fadf9df807b4f5e704d4dd447772943798">parityOddPacked</a>) : <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fab84d144528f1a54d906ec2d9922f3aec">parityNone</a>), <a class="code" href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">m_symmetry</a>,</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <a class="code" href="classmolpro_1_1Operator__.html#a0ce4e4cf159d614704523aecf94e70d4">m_description</a> + <span class="stringliteral">&quot;:dbb&quot;</span>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <a class="code" href="classmolpro_1_1SMat__.html">SMat_&lt;T&gt;</a> inner2(<a class="code" href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">dims_t</a>{m_dimensions[1][0], m_dimensions[0][2]}, dummyBuffer, <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fab84d144528f1a54d906ec2d9922f3aec">parityNone</a>, 0, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                        <a class="code" href="classmolpro_1_1Operator__.html#a0ce4e4cf159d614704523aecf94e70d4">m_description</a> + <span class="stringliteral">&quot;:dba&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classmolpro_1_1Operator__.html#ab1be924f24f25900aad356f0309d9f1a">m_exchange</a>[0] * <a class="code" href="classmolpro_1_1Operator__.html#ab1be924f24f25900aad356f0309d9f1a">m_exchange</a>[1] == 0)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;          <a class="code" href="classmolpro_1_1Operator__.html#abfedd4ed0bb060f4f6ae467efb928dac">m_O2ba_dirac</a> = std::make_shared&lt;SMatMat_&lt;SMat_&lt;T&gt;&gt;&gt;(inner2, <a class="code" href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">dims_t</a>{m_dimensions[1][1], m_dimensions[0][3]},</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                                              <span class="keyword">nullptr</span>, <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fab84d144528f1a54d906ec2d9922f3aec">parityNone</a>, <a class="code" href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">m_symmetry</a>, <a class="code" href="classmolpro_1_1Operator__.html#a0ce4e4cf159d614704523aecf94e70d4">m_description</a> + <span class="stringliteral">&quot;:dba&quot;</span>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="classmolpro_1_1Operator__.html#aa1233fe514f2df7e486ff86afc8ac0a7">m_O2bb_dirac</a> = <a class="code" href="classmolpro_1_1Operator__.html#a4a1560a5764ad1454f9557ff369372b5">m_O2aa_dirac</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classmolpro_1_1Operator__.html#ab1be924f24f25900aad356f0309d9f1a">m_exchange</a>[0] * <a class="code" href="classmolpro_1_1Operator__.html#ab1be924f24f25900aad356f0309d9f1a">m_exchange</a>[1] == 0)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          <a class="code" href="classmolpro_1_1Operator__.html#abfedd4ed0bb060f4f6ae467efb928dac">m_O2ba_dirac</a> = <a class="code" href="classmolpro_1_1Operator__.html#aac42e52c476f29ff1179fd9be789111f">m_O2ab_dirac</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="classmolpro_1_1Operator__.html#aaccc9d30faf9c4983019259137448f42">m_dirac_out_of_date</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="comment">//  std::cout &lt;&lt; &quot;at end of Operator_&lt;T&gt;::Operator_&lt;T&gt;, memory_remaining()=&quot;&lt;&lt;memory_remaining()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a7f77ca6066c3a89cde14ea50d4a2c424">  118</a></span>&#160;<a class="code" href="classmolpro_1_1Operator__.html#ad7405980136ba27e76d96d4ef9046a88">Operator_&lt;T&gt;::Operator_</a>(<span class="keyword">const</span> <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;</a>&amp; source)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    : <a class="code" href="classmolpro_1_1Operator__.html">Operator_</a>&lt;<a class="code" href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a>&gt;::<a class="code" href="classmolpro_1_1Operator__.html">Operator_</a>(source.m_dimensions, source.m_rank, source.m_uhf, source.m_hermiticity, source.m_exchange,</div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a7f77ca6066c3a89cde14ea50d4a2c424">  120</a></span>&#160;                              source.m_symmetry, source.m_covariant, source.m_diagonal, source.m_description) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  *<span class="keyword">this</span> = source;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#ab9db718a668d87b5a3383f0399e2989b">  124</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;</a>&amp; <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;::operator=</a>(<span class="keyword">const</span> <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;</a>&amp; source) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  checkCompatible(source);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  m_O0 = source.<a class="code" href="classmolpro_1_1Operator__.html#a16bf7f125cb7fbf5e26d5102d3311483">m_O0</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  *m_O1a = *source.<a class="code" href="classmolpro_1_1Operator__.html#a468d6e8eb978198531c2c90776f9ebaa">m_O1a</a>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">if</span> (m_rank &gt; 1)</div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a420f17fcb448c0596d357cb6b5e850bb">  129</a></span>&#160;    *m_O2aa_mulliken = *source.<a class="code" href="classmolpro_1_1Operator__.html#ada91d58116a902824c0db68affb93c53">m_O2aa_mulliken</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">if</span> (m_uhf) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    *m_O1b = *source.<a class="code" href="classmolpro_1_1Operator__.html#aa19f592a7a1eb89168d50f8e92b85160">m_O1b</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (m_rank &gt; 1)</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      *m_O2ab_mulliken = *source.<a class="code" href="classmolpro_1_1Operator__.html#ac507cb97c4b761359154c2cafc71038f">m_O2ab_mulliken</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (m_rank &gt; 1)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      *m_O2bb_mulliken = *source.<a class="code" href="classmolpro_1_1Operator__.html#a036e2e9bc406cf44c59af8a6580898b7">m_O2bb_mulliken</a>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  m_dirac_out_of_date = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a420f17fcb448c0596d357cb6b5e850bb">  141</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;</a> <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;::construct</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* dump) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keyword">class </span>molpro::bytestream bs(dump);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classmolpro_1_1Operator__.html#a420f17fcb448c0596d357cb6b5e850bb">Operator_&lt;T&gt;::construct</a>(bs);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;}</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#aab5169519cb3db69c09654308fcf2c60">  146</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;</a> <a class="code" href="classmolpro_1_1Operator__.html#a420f17fcb448c0596d357cb6b5e850bb">Operator_&lt;T&gt;::construct</a>(<span class="keyword">class</span> molpro::bytestream&amp; bs) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  std::array&lt;dims_t, 2&gt; dimensions;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> spin = 0; spin &lt; 2; spin++)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> axis = 0; axis &lt; 4; axis++) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keyword">auto</span> ii = bs.ints();</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      dimensions[spin].push_back(<a class="code" href="namespacemolpro.html#a67177c2ad49feab84008cc04c3bb1f7c">dim_t</a>(ii.size()));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; ii.size(); k++)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        dimensions[spin].back()[k] = ii[k];</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordtype">int</span> rank;                     </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordtype">bool</span> uhf;                     </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  std::vector&lt;int&gt; hermiticity; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  std::vector&lt;int&gt; exchange;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> symmetry;   </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  std::string description; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  rank = bs.ints()[0];</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  uhf = bs.ints()[0];</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keyword">auto</span> ii = bs.ints();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    hermiticity.push_back(ii[0]);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    hermiticity.push_back(ii[1]);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keyword">auto</span> ii = bs.ints();</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    exchange.push_back(ii[0]);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    exchange.push_back(ii[1]);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  symmetry = bs.ints()[0];</div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">  178</a></span>&#160;  <span class="keywordtype">bool</span> covariant = bs.ints()[0] != 0;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keyword">auto</span> dd = bs.chars();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    description.resize(dd.size());</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    std::copy(dd.begin(), dd.end(), description.begin());</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordtype">bool</span> dirac_out_of_date = bs.ints()[0] != 0;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;</a> result(dimensions, rank, uhf, hermiticity, exchange, symmetry, covariant, <span class="keyword">false</span>, description);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  result.m_O0 = bs.doubles()[0];</div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a6dca1a22715063777629a87ded042396">  187</a></span>&#160;  <span class="keywordflow">if</span> (result.m_rank &gt; 0) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    result.m_O1a = std::make_shared&lt;SMat_&lt;T&gt;&gt;(bs.byteStream());</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    result.m_O1b = result.m_uhf ? std::make_shared&lt;SMat_&lt;T&gt;&gt;(bs.byteStream()) : result.m_O1a;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">if</span> (result.m_rank &gt; 1) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    result.m_O2aa_mulliken = std::make_shared&lt;SMatMat_&lt;SMat_&lt;T&gt;&gt;&gt;(bs.byteStream());</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    result.m_O2ab_mulliken =</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        result.m_uhf ? std::make_shared&lt;SMatMat_&lt;SMat_&lt;T&gt;&gt;&gt;(bs.byteStream()) : result.m_O2aa_mulliken;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    result.m_O2bb_mulliken =</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        result.m_uhf ? std::make_shared&lt;<a class="code" href="classmolpro_1_1SMatMat__.html">SMatMat_</a>&lt;<a class="code" href="classmolpro_1_1SMat__.html">SMat_&lt;T&gt;</a>&gt;&gt;(bs.byteStream()) : result.m_O2aa_mulliken;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    if (!dirac_out_of_date) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      result.m_O2aa_dirac = std::make_shared&lt;SMatMat_&lt;SMat_&lt;T&gt;&gt;&gt;(bs.byteStream());</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      result.m_O2ab_dirac = result.m_uhf ? std::make_shared&lt;SMatMat_&lt;SMat_&lt;T&gt;&gt;&gt;(bs.byteStream()) : result.m_O2aa_dirac;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      result.m_O2bb_dirac = result.m_uhf ? std::make_shared&lt;<a class="code" href="classmolpro_1_1SMatMat__.html">SMatMat_</a>&lt;<a class="code" href="classmolpro_1_1SMat__.html">SMat_&lt;T&gt;</a>&gt;&gt;(bs.byteStream()) : result.m_O2aa_dirac;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      result.m_dirac_out_of_date = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="keyword">class </span><a class="code" href="classmolpro_1_1Operator__.html">Operator_</a>&lt;<a class="code" href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a>&gt; <a class="code" href="classmolpro_1_1Operator__.html">Operator_</a>&lt;<a class="code" href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a>&gt;::slice(std::array&lt;dims_t, 2&gt; dimensions, std::array&lt;dims_t, 2&gt; offset,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                       std::string description) const {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keyword">auto</span> hermiticity = m_hermiticity;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> spin = 0; spin &lt; 2; spin++)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> particle = 0; particle &lt; m_rank; particle++)</div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a70901845f6938d7330cba6ddf2263a44">  213</a></span>&#160;      <span class="keywordflow">if</span> (dimensions[spin][particle * 2] != dimensions[spin][particle * 2 + 1])</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        hermiticity[particle] = 0;</div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a5f79ce00954d821a90f47653c876199e">  215</a></span>&#160;  <span class="keyword">auto</span> exchange = m_exchange;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordflow">if</span> (m_rank &gt; 1) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> spin = 0; spin &lt; 2; spin++)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> braket = 0; braket &lt; 2; braket++)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">if</span> (dimensions[spin][braket] != dimensions[spin][braket + 2])</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          exchange[braket] = 0;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <a class="code" href="classmolpro_1_1Operator__.html">Operator_</a> result(dimensions, this-&gt;m_rank, this-&gt;m_uhf, hermiticity, exchange, this-&gt;m_symmetry, this-&gt;m_covariant,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                   this-&gt;m_diagonal, description == <span class="stringliteral">&quot;&quot;</span> ? this-&gt;m_description : description);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  *result.m_O1a = m_O1a-&gt;slice(dimensions[0], offset[0]);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">if</span> (m_uhf)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    *result.m_O1b = m_O1b-&gt;slice(dimensions[1], offset[1]);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">if</span> (m_rank &gt; 1) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">throw</span> std::logic_error(<span class="stringliteral">&quot;no implementation&quot;</span>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#ad34403a5cf7a4cd77944d1f5e54bda13">  231</a></span>&#160;}</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a04873a23f31ee4da6e98e632f538b0b8">  234</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;::ensure_dirac</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordflow">if</span> (m_rank &gt; 1)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> (m_dirac_out_of_date &amp;&amp; m_covariant) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      m_dirac_out_of_date = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">false</span>)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        std::cout &lt;&lt; O2(<span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a1d2d5660ff702b36c528629ab5aaee76">  240</a></span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">false</span>) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> symik = 0; symik &lt; 8; symik += 4)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> symi = 0; symi &lt; 8; symi += 4)</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; m_dimensions[0][0][symi]; i++)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; m_dimensions[0][0][symik ^ symi]; k++) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;@@ Mulliken integrals for i=&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; symi &lt;&lt; <span class="stringliteral">&quot;, k=&quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; (symi ^ symik)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                          &lt;&lt; std::endl;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                std::cout &lt;&lt; *(O2(<span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>).smat(symik, symi, i, k)) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;              }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">false</span>) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0, symi = 0, k = 1, symk = 4, symik = 4;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;@@ Mulliken integrals for i=&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; symi &lt;&lt; <span class="stringliteral">&quot;, k=&quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; (symi ^ symik)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        std::cout &lt;&lt; (O2(<span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>).smat(symik, symi, i, k))-&gt;str(<span class="stringliteral">&quot;&quot;</span>, 3) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="comment">//        std::swap(i,k);</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        std::swap(symi, symk);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;@@ Mulliken integrals for i=&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; symi &lt;&lt; <span class="stringliteral">&quot;, k=&quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; (symi ^ symik)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a1b8666aedb49899b0176cef3fe5d94ec">  259</a></span>&#160;        std::cout &lt;&lt; (O2(<span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>).smat(symik, symi, i, k))-&gt;str(<span class="stringliteral">&quot;&quot;</span>, 3) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a6179fc8618d97b316f340239f8cee816">  260</a></span>&#160;      }</div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a92a18303329a4a9a8f1aedc1c20435dc">  261</a></span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">false</span>) {</div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#ab93c4112118146afd29556550d07467f">  262</a></span>&#160;        <a class="code" href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a> el1 = element(1, 0, 0, 4, 0, 0, 1, 4);</div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a87ab2b8812f1233c41f57fcd5ffc4265">  263</a></span>&#160;        <a class="code" href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a> el2 = element(1, 4, 0, 0, 0, 4, 1, 0);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;@@@ el1=&quot;</span> &lt;&lt; el1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;@@@ el2=&quot;</span> &lt;&lt; el2 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="comment">//      exit(0);</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordflow">if</span> (m_hermiticity[0] * m_hermiticity[1] != 1 || m_exchange[0] * m_exchange[1] != 1 || m_symmetry != 0)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">throw</span> std::logic_error(</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="stringliteral">&quot;Dirac ordering of integrals not yet implemented for this combination of hermiticity/exchange symmetry&quot;</span>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> symik = 0; symik &lt; 8; symik++) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">if</span> (m_O2ab_dirac-&gt;block_size(symik) &lt;= 0)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="comment">//          std::cout &lt;&lt; &quot;@@symik=&quot;&lt;&lt;symik&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> symi = 0; symi &lt; 8; symi++) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> symj = 0; symj &lt; 8; symj++) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> symk = symi ^ symik;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> syml = symj ^ symik;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="comment">//                  std::cout &lt;&lt; &quot;symi=&quot;&lt;&lt;symi&lt;&lt;&quot; symj=&quot;&lt;&lt;symj&lt;&lt; &quot; symk=&quot;&lt;&lt;symk&lt;&lt;&quot; syml=&quot;&lt;&lt;syml&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="comment">//                  if (symi &lt;= symk &amp;&amp; symj &lt;= syml)</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; m_dimensions[0][2][symj]; j++)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> l = 0; l &lt; m_dimensions[1][3][syml]; l++) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                  <span class="keywordtype">size_t</span> ki = 0;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_dimensions[0][0][symi]; i++)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; m_dimensions[1][1][symk]; k++) {</div>
<div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a9227a41e2d01d3e9c2322878ed2431e0">  287</a></span>&#160;                      <span class="comment">//                            std::cout &lt;&lt; &quot;opposite spin</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                      <span class="comment">//                            &lt;&quot;&lt;&lt;i&lt;&lt;&quot;.&quot;&lt;&lt;symi&lt;&lt;&quot;,&quot;&lt;&lt;k&lt;&lt;&quot;||&quot;&lt;&lt;j&lt;&lt;l&lt;&lt;&quot;&gt;=&quot;&lt;&lt;</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                      <span class="comment">//                            &quot;(&quot;&lt;&lt;i&lt;&lt;j&lt;&lt;&quot;|&quot;&lt;&lt;k&lt;&lt;l&lt;&lt;&quot;) = &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                      <span class="comment">//                            element(i,symi,j,symj,k,symk,l,syml,true,false)&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                      O2(<span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>).smat(symik, syml, l, j)-&gt;block(symk)[ki] =</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                          element(i, symi, j, symj, k, symk, l, syml, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                      ki++;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                    }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                }</div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#ab701242e04c76327c6d0a88aaf4b3859">  296</a></span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; m_dimensions[0][2][symj]; j++)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> l = 0; l &lt; (symik ? m_dimensions[0][3][syml] : j); l++) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                  <span class="keywordtype">size_t</span> ki = 0;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; m_dimensions[0][1][symk]; k++)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; (symik ? m_dimensions[0][0][symi] : k); i++) {</div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a04873a23f31ee4da6e98e632f538b0b8">  301</a></span>&#160;                      O2(<span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>).smat(symik, syml, l, j)-&gt;block(symk)[ki] =</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                          symik ? (element(i, symi, j, symj, k, symk, l, syml, <span class="keyword">true</span>, <span class="keyword">true</span>) -</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                   element(i, symi, l, syml, k, symk, j, symj, <span class="keyword">true</span>, <span class="keyword">true</span>))</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                : (element(i, symi, l, syml, k, symk, j, symj, <span class="keyword">true</span>, <span class="keyword">true</span>) -</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                   element(i, symi, j, symj, k, symk, l, syml, <span class="keyword">true</span>, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a2c884131888790d27bcf65f6001afda5">  306</a></span>&#160;                      ki++;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                    }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; m_dimensions[1][2][symj]; j++)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> l = 0; l &lt; (symik ? m_dimensions[1][3][syml] : j); l++) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                  <span class="keywordtype">size_t</span> ki = 0;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; m_dimensions[1][1][symk]; k++)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; (symik ? m_dimensions[1][0][symi] : k); i++) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                      O2(<span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>).smat(symik, syml, l, j)-&gt;block(symk)[ki] =</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                          symik ? (element(i, symi, j, symj, k, symk, l, syml, <span class="keyword">true</span>, <span class="keyword">true</span>) -</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                                   element(i, symi, l, syml, k, symk, j, symj, <span class="keyword">true</span>, <span class="keyword">true</span>))</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                                : (element(i, symi, l, syml, k, symk, j, symj, <span class="keyword">true</span>, <span class="keyword">true</span>) -</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                                   element(i, symi, j, symj, k, symk, l, syml, <span class="keyword">true</span>, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                      O2(<span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>).smat(symik, syml, l, j)-&gt;block(symk)[ki] =</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                          symik ? (element(i, symi, j, symj, k, symk, l, syml, <span class="keyword">false</span>, <span class="keyword">false</span>) -</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                                   element(i, symi, l, syml, k, symk, j, symj, <span class="keyword">false</span>, <span class="keyword">false</span>))</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                                : (element(i, symi, l, syml, k, symk, j, symj, <span class="keyword">false</span>, <span class="keyword">false</span>) -</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                   element(i, symi, j, symj, k, symk, l, syml, <span class="keyword">false</span>, <span class="keyword">false</span>));</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                      ki++;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                    }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;          }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="comment">//          std::cout &lt;&lt; &quot; block_offsets:&quot;; for (auto ii=0; ii&lt;8; ii++) std::cout &lt;&lt;&quot;</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="comment">//          &quot;&lt;&lt;m_O2aa_dirac-&gt;block_offset(symik,ii); std::cout &lt;&lt; std::endl; if</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="comment">//          (m_O2aa_dirac-&gt;blockM(symik).rows()&gt;0)</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="comment">//            std::cout &lt;&lt; &quot;Dirac aa symmetry block</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="comment">//            &quot;&lt;&lt;&amp;m_O2aa_dirac-&gt;blockM(symik)(0,0)-&amp;m_O2aa_dirac-&gt;blockM(0)(0,0)&lt;&lt;std::endl&lt;&lt;m_O2aa_dirac-&gt;blockM(symik)&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="comment">//          std::cout &lt;&lt; &quot;Dirac ab symmetry block &quot;&lt;&lt;std::endl&lt;&lt;m_O2ab_dirac-&gt;blockM(symik)&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="comment">//                    std::cout &lt;&lt;</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="comment">//                    &quot;m_O2aa_dirac-element=&quot;&lt;&lt;&amp;m_O2aa_dirac-&gt;block(0)[0]-&amp;m_O2aa_mulliken-&gt;block(0)[0]&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;}</div>
<div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a9227a41e2d01d3e9c2322878ed2431e0">  341</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;::mulliken_from_dirac</a>() {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordflow">if</span> (m_rank &gt; 1) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">//      std::cout &lt;&lt; &quot;@@ mulliken_from_dirac&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">//          std::cout &lt;&lt; &quot;Dirac ab symmetry block &quot;&lt;&lt;std::endl&lt;&lt;m_O2ab_dirac-&gt;blockM(0)&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">//          std::cout &lt;&lt; &quot;Dirac ab &quot;&lt;&lt;std::endl&lt;&lt;O2(true,false,false)&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">//      std::cout &lt;&lt;str(&quot;at start of from_dirac&quot;,2)&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">false</span>)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      std::cout &lt;&lt; O2(<span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">if</span> (m_hermiticity[0] != m_hermiticity[1] || m_exchange[0] * m_exchange[1] != 1 || m_symmetry != 0)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keywordflow">throw</span> std::logic_error(</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;          <span class="stringliteral">&quot;Dirac ordering of integrals not yet implemented for this combination of hermiticity/exchange symmetry&quot;</span>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> symik = 0; symik &lt; 8; symik++) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="keywordflow">if</span> (m_O2ab_dirac-&gt;block_size(symik) &lt;= 0)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> symi = 0; symi &lt; 8; symi++) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> symj = 0; symj &lt; 8; symj++) {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> symk = symi ^ symik;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> syml = symj ^ symik;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;          <span class="comment">//          size_t ni = m_dimensions[0][symi];</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          <span class="comment">//          size_t nj = m_dimensions[0][symj];</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;          <span class="comment">//          size_t nk = m_dimensions[0][symk];</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;          <span class="comment">//          size_t nl = m_dimensions[0][syml];</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;          <span class="comment">//          if (ni * ni * nk * nl == 0) continue;</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;          {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <span class="keywordflow">if</span> (m_uhf) {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; m_dimensions[0][2][symj]; j++)</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> l = 0; l &lt; m_dimensions[1][3][syml]; l++) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                  <span class="keywordtype">size_t</span> ki = 0;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_dimensions[0][0][symi]; i++)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; m_dimensions[1][1][symk]; k++) {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                      element(i, symi, j, symj, k, symk, l, syml, <span class="keyword">true</span>, <span class="keyword">false</span>) =</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                          O2(<span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                              .smat(symik, syml, l,</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                                    j)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                              -&gt;block(symk)[ki]; <span class="comment">// TODO do we really have lj or jl?</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                      <span class="comment">//                                std::cout &lt;&lt; &quot;opposite spin</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                      <span class="comment">//                                &lt;&quot;&lt;&lt;i&lt;&lt;&quot;.&quot;&lt;&lt;symi&lt;&lt;&quot;,&quot;&lt;&lt;k&lt;&lt;&quot;||&quot;&lt;&lt;j&lt;&lt;l&lt;&lt;&quot;&gt;=&quot;&lt;&lt;</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                      <span class="comment">//                                &quot;(&quot;&lt;&lt;i&lt;&lt;j&lt;&lt;&quot;|&quot;&lt;&lt;k&lt;&lt;l&lt;&lt;&quot;) = &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                      <span class="comment">//                                element(i,symi,j,symj,k,symk,l,syml,true,false)&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                      ki++;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; m_dimensions[0][2][symj]; j++)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> l = 0; l &lt; (symik ? m_dimensions[0][3][syml] : j); l++) {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                  <span class="comment">//                      for (size_t l=(symik?0:j+1); l&lt;nl; l++) {</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                  <span class="keywordtype">size_t</span> ki = 0;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; m_dimensions[0][1][symk]; k++)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    <span class="comment">//                            for (size_t i=(symik ? 0 : k+1); i&lt;ni; i++) {</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; (symik ? m_dimensions[0][0][symi] : k); i++) {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                      <span class="keywordflow">if</span> (symik) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                        element(i, symi, l, syml, k, symk, j, symj, <span class="keyword">true</span>, <span class="keyword">true</span>) =</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                            -(element(i, symi, j, symj, k, symk, l, syml, <span class="keyword">true</span>, <span class="keyword">true</span>) =</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                                  O2(<span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>).smat(symik, syml, l, j)-&gt;block(symk)[ki]);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                        element(i, symi, j, symj, k, symk, l, syml, <span class="keyword">true</span>, <span class="keyword">true</span>) =</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                            -(element(i, symi, l, syml, k, symk, j, symj, <span class="keyword">true</span>, <span class="keyword">true</span>) =</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                  O2(<span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>).smat(symik, syml, l, j)-&gt;block(symk)[ki]);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                      }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                      ki++;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                    }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; m_dimensions[1][2][symj]; j++)</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> l = 0; l &lt; (symik ? m_dimensions[1][3][syml] : j); l++) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                  <span class="comment">//                      for (size_t l=(symik?0:j+1); l&lt;nl; l++) {</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                  <span class="keywordtype">size_t</span> ki = 0;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; m_dimensions[1][1][symk]; k++)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                    <span class="comment">//                            for (size_t i=(symik ? 0 : k+1); i&lt;ni; i++) {</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; (symik ? m_dimensions[1][0][symi] : k); i++) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                      <span class="keywordflow">if</span> (symik) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                        element(i, symi, l, syml, k, symk, j, symj, <span class="keyword">false</span>, <span class="keyword">false</span>) =</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                            -(element(i, symi, j, symj, k, symk, l, syml, <span class="keyword">false</span>, <span class="keyword">false</span>) =</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                                  O2(<span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>).smat(symik, syml, l, j)-&gt;block(symk)[ki]);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        element(i, symi, j, symj, k, symk, l, syml, <span class="keyword">false</span>, <span class="keyword">false</span>) =</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                            -(element(i, symi, l, syml, k, symk, j, symj, <span class="keyword">false</span>, <span class="keyword">false</span>) =</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                  O2(<span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>).smat(symik, syml, l, j)-&gt;block(symk)[ki]);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                      }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                      ki++;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                    }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            } <span class="keywordflow">else</span> { <span class="comment">// ! m_uhf</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;              <span class="keywordflow">if</span> (m_symmetry != 0)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Non-symmetric operator not yet implemented&quot;</span>);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;              <span class="comment">//                        std::cout &lt;&lt;symi&lt;&lt;symj&lt;&lt;symk&lt;&lt;syml&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;              <span class="comment">//                        std::cout &lt;&lt; &quot;element(1,0,1,0,0,0,0,0,true,true,false)  &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;              <span class="comment">//                        element(1,0,1,0,0,0,0,0,true,true,false) &lt;&lt;std::endl; std::cout &lt;&lt;</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;              <span class="comment">//                        &quot;element(1,0,0,0,1,0,0,0,true,true,false)  &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;              <span class="comment">//                        element(1,0,0,0,1,0,0,0,true,true,false) &lt;&lt;std::endl; std::cout &lt;&lt;</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;              <span class="comment">//                        &quot;element(1,0,0,0,0,0,1,0,true,true,false)  &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;              <span class="comment">//                        element(1,0,0,0,0,0,1,0,true,true,false) &lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_dimensions[0][0][symi]; i++)</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; ((m_hermiticity[0] != 0 &amp;&amp; symi == symj) ? i + (m_hermiticity[0] == -1 ? 0 : 1)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                                                                : m_dimensions[0][2][symj]);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                     j++)</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; m_dimensions[0][1][symk]; k++) {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> l = 0;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                         l &lt; ((m_hermiticity[1] != 0 &amp;&amp; symk == syml) ? k + (m_hermiticity[0] == -1 ? 0 : 1)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                                                      : m_dimensions[0][3][syml]);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                         l++) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                      m_dirac_out_of_date = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                      <span class="comment">//                                  size_t ki=k+i*nk;</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                      <span class="comment">//                                    std::cout &lt;&lt; &quot;spin summed &lt;&quot;</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                      <span class="comment">//                                             &lt;&lt; &quot;(&quot;&lt;&lt;i&lt;&lt;j&lt;&lt;&quot;|&quot;&lt;&lt;k&lt;&lt;l&lt;&lt;&quot;) = &quot;;</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                      element(i, symi, j, symj, k, symk, l, syml, <span class="keyword">true</span>, <span class="keyword">true</span>) =</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                          element(i, symi, k, symk, l, syml, j, symj, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>) +</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                          element(k, symk, i, symi, j, symj, l, syml, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>) +</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                          element(i, symi, k, symk, l, syml, j, symj, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>) +</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                          element(i, symi, l, syml, k, symk, j, symj, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                    }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                  }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;              <span class="comment">//                        std::cout &lt;&lt; &quot;element(1,0,1,0,0,0,0,0,true,false,true)  &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;              <span class="comment">//                        element(1,0,1,0,0,0,0,0,true,false,true) &lt;&lt;std::endl; std::cout &lt;&lt;</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;              <span class="comment">//                        &quot;element(1,0,0,0,1,0,0,0,true,false,true)  &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;              <span class="comment">//                        element(1,0,0,0,1,0,0,0,true,false,true) &lt;&lt;std::endl; std::cout &lt;&lt;</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;              <span class="comment">//                        &quot;element(1,0,0,0,0,0,1,0,true,false,true)  &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;              <span class="comment">//                        element(1,0,0,0,0,0,1,0,true,false,true) &lt;&lt;std::endl; std::cout &lt;&lt;</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;              <span class="comment">//                        &quot;element(1,0,1,0,0,0,0,0,true,true,true)  &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;              <span class="comment">//                        element(1,0,1,0,0,0,0,0,true,true,true) &lt;&lt;std::endl; std::cout &lt;&lt;</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;              <span class="comment">//                        &quot;element(1,0,0,0,1,0,0,0,true,true,true)  &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;              <span class="comment">//                        element(1,0,0,0,1,0,0,0,true,true,true) &lt;&lt;std::endl; std::cout &lt;&lt;</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;              <span class="comment">//                        &quot;element(1,0,0,0,0,0,1,0,true,true,true)  &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;              <span class="comment">//                        element(1,0,0,0,0,0,1,0,true,true,true) &lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;          }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    m_dirac_out_of_date = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">//      std::cout &lt;&lt;str(&quot;at end of from_dirac&quot;,2)&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;}</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">  473</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">const</span> <a class="code" href="classmolpro_1_1SMat__.html">SMat_&lt;T&gt;</a>&amp; <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;::O1</a>(<span class="keywordtype">bool</span> spinUp)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordflow">if</span> (spinUp)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">return</span> *m_O1a;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">return</span> *m_O1b;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;}</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a6dca1a22715063777629a87ded042396">  480</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">const</span> <a class="code" href="classmolpro_1_1SMatMat__.html">SMatMat_&lt;SMat_&lt;T&gt;</a>&gt;&amp; <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;::O2</a>(<span class="keywordtype">bool</span> spinUp1, <span class="keywordtype">bool</span> spinUp2, <span class="keywordtype">bool</span> mulliken, <span class="keywordtype">bool</span> ensure)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordflow">if</span> (mulliken)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">if</span> (spinUp1)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordflow">if</span> (spinUp2)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">return</span> *m_O2aa_mulliken;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keywordflow">return</span> *m_O2ab_mulliken;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (spinUp2)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keywordflow">return</span> *m_O2ba_mulliken;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="keywordflow">return</span> *m_O2bb_mulliken;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">if</span> (ensure)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      ensure_dirac();</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">if</span> (spinUp1)</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">if</span> (spinUp2)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="keywordflow">return</span> *m_O2aa_dirac;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordflow">return</span> *m_O2ab_dirac;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (spinUp2)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="keywordflow">return</span> *m_O2ba_dirac;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">return</span> *m_O2bb_dirac;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;}</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><a name="l00507"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a70901845f6938d7330cba6ddf2263a44">  507</a></span>&#160;<span class="keyword">const</span> <a class="code" href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a>&amp; <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;::element</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> isym, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> jsym, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> ksym, <span class="keywordtype">int</span> l, <span class="keywordtype">int</span> lsym, <span class="keywordtype">bool</span> spinUp1,</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                               <span class="keywordtype">bool</span> spinUp2, <span class="keywordtype">bool</span> mulliken)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="comment">//  std::cout &lt;&lt;&quot;=====\nelement</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="comment">//  (&quot;&lt;&lt;i&lt;&lt;&quot;.&quot;&lt;&lt;isym&lt;&lt;&quot;,&quot;&lt;&lt;j&lt;&lt;&quot;.&quot;&lt;&lt;jsym&lt;&lt;&quot;,&quot;&lt;&lt;k&lt;&lt;&quot;.&quot;&lt;&lt;ksym&lt;&lt;&quot;,&quot;&lt;&lt;l&lt;&lt;&quot;.&quot;&lt;&lt;lsym&lt;&lt;&quot;)&quot;&lt;&lt;spinUp1&lt;&lt;spinUp2&lt;&lt;mulliken&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordflow">if</span> (k &lt; 0) { <span class="comment">// 1-particle</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">if</span> (m_hermiticity[0])</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <span class="keywordflow">return</span> O1(spinUp1).block(isym)[i &gt; j ? i * (i + 1) / 2 + j : j * (j + 1) / 2 + i];</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;O1(spinUp1).blockMap(isym)(i, j);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  } <span class="keywordflow">else</span> { <span class="comment">// 2-particle</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">if</span> (((mulliken &amp;&amp; m_hermiticity[0]) || (!mulliken &amp;&amp; m_exchange[0] &amp;&amp; spinUp1 == spinUp2)) &amp;&amp; (ksym == lsym)) {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="keyword">auto</span> m = O2(spinUp1, spinUp2, mulliken).smat(ksym ^ lsym, ksym, k, l);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="comment">//          std::cout &lt;&lt; &quot;smat\n&quot;&lt;&lt;*m&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="keywordflow">if</span> ((m-&gt;parity() == <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fa5d5c6a3594b6f312d3d19b349ca8d25e">parityOdd</a> || m-&gt;parity() == <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fadf9df807b4f5e704d4dd447772943798">parityOddPacked</a>) &amp;&amp; (k == l || i == j))</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordflow">return</span> constants.s_zero; <span class="comment">// FIXME not thread-safe</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <a class="code" href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a> phase = (i &gt; j ? 1 : m_hermiticity[0]) * (k &gt; l ? 1 : m_hermiticity[1]);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="keywordflow">if</span> (m-&gt;parity() == <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fadf9df807b4f5e704d4dd447772943798">parityOddPacked</a>)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordflow">return</span> constants.return_value = phase * m-&gt;block(isym)[i &gt; j ? i * (i - 1) / 2 + j : j * (j - 1) / 2 + i];</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keywordflow">return</span> constants.return_value = phase * m-&gt;block(isym)[i &gt; j ? i * (i + 1) / 2 + j : j * (j + 1) / 2 + i];</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isym &gt; jsym) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">false</span>) {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;element rectangular block 1 (&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                  &lt;&lt; *O2(spinUp1, spinUp2, mulliken).smat(ksym ^ lsym, ksym, k, l) &lt;&lt; std::endl</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                  &lt;&lt; O2(spinUp1, spinUp2, mulliken).smat(ksym ^ lsym, ksym, k, l)-&gt;blockMap(isym).rows() &lt;&lt; std::endl</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                  &lt;&lt; O2(spinUp1, spinUp2, mulliken).smat(ksym ^ lsym, ksym, k, l)-&gt;blockMap(isym).cols() &lt;&lt; std::endl</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                  &lt;&lt; O2(spinUp1, spinUp2, mulliken).smat(ksym ^ lsym, ksym, k, l)-&gt;blockMap(isym) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="keyword">auto</span> m = O2(spinUp1, spinUp2, mulliken).smat(ksym ^ lsym, ksym, k, l);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="keywordflow">if</span> (m-&gt;parity() == <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fadf9df807b4f5e704d4dd447772943798">parityOddPacked</a>) {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <a class="code" href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a> phase = (ksym &gt; lsym ? 1 : m_hermiticity[1]);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keywordflow">return</span> constants.return_value = phase * m-&gt;blockMap(isym)(i, j);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">return</span> m-&gt;blockMap(isym)(i, j);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">false</span>) {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keyword">auto</span> m = O2(spinUp1, spinUp2, mulliken).smat(ksym ^ lsym, ksym, k, l)-&gt;blockMap(jsym);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;element rectangular block 2 (&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                  &lt;&lt; m.rows() &lt;&lt; m.cols() &lt;&lt; std::endl</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;isym=&quot;</span> &lt;&lt; isym &lt;&lt; std::endl</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;jsym=&quot;</span> &lt;&lt; jsym &lt;&lt; std::endl</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;m=blockMap(jsym):\n&quot;</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                  &lt;&lt; m &lt;&lt; std::endl</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;blockMap(isym):\n&quot;</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                  &lt;&lt; O2(spinUp1, spinUp2, mulliken).smat(ksym ^ lsym, ksym, k, l)-&gt;blockMap(isym) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;m(0,) &quot;</span> &lt;&lt; m(0, 0) &lt;&lt; m(0, 1) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;m(1,) &quot;</span> &lt;&lt; m(1, 0) &lt;&lt; m(1, 1) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        std::cout &lt;&lt; m(j, i) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="keyword">auto</span> m = O2(spinUp1, spinUp2, mulliken).smat(ksym ^ lsym, ksym, k, l);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="keywordflow">if</span> (m-&gt;parity() == <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fadf9df807b4f5e704d4dd447772943798">parityOddPacked</a>) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <a class="code" href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a> phase = (ksym &gt; lsym ? 1 : m_hermiticity[1]) * m_hermiticity[0];</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="keywordflow">return</span> constants.return_value = phase * m-&gt;blockMap(jsym)(j, i);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keywordflow">return</span> O2(spinUp1, spinUp2, mulliken).smat(ksym ^ lsym, ksym, k, l)-&gt;blockMap(jsym)(j, i);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;}</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a5f79ce00954d821a90f47653c876199e">  566</a></span>&#160;<a class="code" href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a>&amp; <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;::element</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> isym, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> jsym, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> ksym, <span class="keywordtype">int</span> l, <span class="keywordtype">int</span> lsym, <span class="keywordtype">bool</span> spinUp1,</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                         <span class="keywordtype">bool</span> spinUp2) {</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  m_dirac_out_of_date = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code" href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a>&amp;<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;element(i, isym, j, jsym, k, ksym, l, lsym, spinUp1, spinUp2, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;}</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#ad34403a5cf7a4cd77944d1f5e54bda13">  573</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; std::string <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;::str</a>(std::string title, <span class="keywordtype">int</span> level)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordflow">if</span> (level &lt; 0)</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="keywordflow">if</span> (title.empty())</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    title = m_description;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  std::stringstream s;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  s &lt;&lt; <span class="stringliteral">&quot;Operator_&lt;T&gt; &quot;</span> &lt;&lt; (title.empty() ? m_description : title);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  s &lt;&lt; <span class="stringliteral">&quot;; rank=&quot;</span> &lt;&lt; m_rank;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  s &lt;&lt; <span class="stringliteral">&quot;; symmetry=&quot;</span> &lt;&lt; m_symmetry + 1;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  s &lt;&lt; <span class="stringliteral">&quot;; hermiticity=&quot;</span> &lt;&lt; m_hermiticity[0] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; m_hermiticity[0];</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">if</span> (m_rank &gt; 1)</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    s &lt;&lt; <span class="stringliteral">&quot;; exchange=&quot;</span> &lt;&lt; m_exchange[0] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; m_exchange[0];</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  s &lt;&lt; std::endl;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordflow">if</span> (level &gt; 0) {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    s &lt;&lt; <span class="stringliteral">&quot;Constant part: &quot;</span> &lt;&lt; m_O0 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">if</span> (m_rank &gt; 0)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      s &lt;&lt; O1(<span class="keyword">true</span>).<a class="code" href="classmolpro_1_1Operator__.html#ad34403a5cf7a4cd77944d1f5e54bda13">str</a>(title + <span class="stringliteral">&quot;: 1-particle, &quot;</span> + (m_uhf ? <span class="stringliteral">&quot;alpha&quot;</span> : <span class="stringliteral">&quot;spin-free&quot;</span>), level) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">if</span> (m_rank &gt; 0 &amp;&amp; m_uhf)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      s &lt;&lt; O1(<span class="keyword">false</span>).str(title + <span class="stringliteral">&quot;: 1-particle, beta&quot;</span>, level) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    ensure_dirac();</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">if</span> (m_O2aa_mulliken != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      s &lt;&lt; O2(<span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;               .str(title + <span class="stringliteral">&quot;: 2-particle, &quot;</span> + (m_uhf ? <span class="stringliteral">&quot;alpha-alpha&quot;</span> : <span class="stringliteral">&quot;spin-free&quot;</span>) + <span class="stringliteral">&quot;, Mulliken&quot;</span>, level)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        &lt;&lt; std::endl;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">if</span> (m_O2ab_mulliken != <span class="keyword">nullptr</span> &amp;&amp; m_uhf)</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      s &lt;&lt; O2(<span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">true</span>).str(title + <span class="stringliteral">&quot;: 2-particle, alpha-beta, Mulliken&quot;</span>, level) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">if</span> (m_O2bb_mulliken != <span class="keyword">nullptr</span> &amp;&amp; m_uhf)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      s &lt;&lt; O2(<span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>).str(title + <span class="stringliteral">&quot;: 2-particle, beta-beta, Mulliken&quot;</span>, level) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordflow">if</span> (m_O2aa_dirac != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      s &lt;&lt; O2(<span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>).str(title + <span class="stringliteral">&quot;: 2-particle, alpha-alpha, Dirac&quot;</span>, level) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">if</span> (m_O2ab_dirac != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      s &lt;&lt; O2(<span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>).str(title + <span class="stringliteral">&quot;: 2-particle, alpha-beta, Dirac&quot;</span>, level) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordflow">if</span> (m_O2bb_dirac != <span class="keyword">nullptr</span> &amp;&amp; m_uhf)</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      s &lt;&lt; O2(<span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>).str(title + <span class="stringliteral">&quot;: 2-particle, beta-beta, Dirac&quot;</span>, level) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="keywordflow">return</span> s.str();</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;}</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><a name="l00612"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a669299f878e03d1e06e65ddf09e3d3d9">  612</a></span>&#160;<a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;</a> <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;::fock</a>(<span class="keyword">const</span> <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;</a>&amp; density, <span class="keywordtype">bool</span> oneElectron, std::string description)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordflow">if</span> (m_exchange[0] &gt;= 0 || m_exchange[1] &gt;= 0 || m_hermiticity[0] * m_hermiticity[1] &lt;= 0)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordflow">throw</span> std::logic_error(<span class="stringliteral">&quot;Operator_&lt;T&gt;::fock can work only with hermitian fermionic hamiltonian&quot;</span>);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="keywordflow">if</span> (m_dimensions[0] != m_dimensions[1])</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">throw</span> std::logic_error(<span class="stringliteral">&quot;Operator_&lt;T&gt;::fock can work only with alpha and beta spaces of same dimension&quot;</span>);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;</a> result(m_dimensions, 1, m_uhf || density.<a class="code" href="classmolpro_1_1Operator__.html#addb215888a5251d81aba6db8f9926b3f">m_uhf</a>, std::vector&lt;int&gt;{1, 1}, std::vector&lt;int&gt;{1, 1},</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                      m_symmetry ^ density.<a class="code" href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">m_symmetry</a>, <span class="keyword">true</span>, <span class="keyword">false</span>, description.empty() ? <span class="stringliteral">&quot;Fock&quot;</span> : description);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  result.<a class="code" href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">O1</a>() = O1();</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keywordflow">if</span> (result.<a class="code" href="classmolpro_1_1Operator__.html#addb215888a5251d81aba6db8f9926b3f">m_uhf</a>)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    result.<a class="code" href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">O1</a>(<span class="keyword">false</span>) = O1(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordflow">if</span> (not oneElectron)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    result.<a class="code" href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">O1</a>() *= 0;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="keywordflow">if</span> (not oneElectron &amp;&amp; result.<a class="code" href="classmolpro_1_1Operator__.html#addb215888a5251d81aba6db8f9926b3f">m_uhf</a>)</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    result.<a class="code" href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">O1</a>(<span class="keyword">false</span>) *= 0;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keywordflow">if</span> (density.<a class="code" href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">m_rank</a> == 1) {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> symk = 0; symk &lt; 8; symk++) {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> syml = symk ^ result.<a class="code" href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">m_symmetry</a>;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordflow">if</span> (m_hermiticity[1] &amp;&amp; syml &gt; symk)</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; m_dimensions[0][2][symk]; k++) {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> l = (m_hermiticity[1] &amp;&amp; symk == syml) ? k : 0; l &lt; m_dimensions[0][3][syml]; l++) {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;          <span class="keywordflow">if</span> (result.<a class="code" href="classmolpro_1_1Operator__.html#addb215888a5251d81aba6db8f9926b3f">m_uhf</a>) {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            result.<a class="code" href="classmolpro_1_1Operator__.html#a70901845f6938d7330cba6ddf2263a44">element</a>(k, symk, l, syml, <span class="keyword">true</span>) +=</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                ((density.<a class="code" href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">O1</a>(<span class="keyword">true</span>)) &amp; (*O2(<span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>).smat(result.<a class="code" href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">m_symmetry</a>, symk, k, l))) +</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                ((density.<a class="code" href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">O1</a>(<span class="keyword">false</span>)) &amp; (*O2(<span class="keyword">false</span>, <span class="keyword">true</span>, <span class="keyword">true</span>).smat(result.<a class="code" href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">m_symmetry</a>, symk, k, l)));</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            result.<a class="code" href="classmolpro_1_1Operator__.html#a70901845f6938d7330cba6ddf2263a44">element</a>(k, symk, l, syml, <span class="keyword">false</span>) +=</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                ((density.<a class="code" href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">O1</a>(<span class="keyword">true</span>)) &amp; (*O2(<span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">true</span>).smat(result.<a class="code" href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">m_symmetry</a>, symk, k, l))) +</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                ((density.<a class="code" href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">O1</a>(<span class="keyword">false</span>)) &amp; (*O2(<span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>).smat(result.<a class="code" href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">m_symmetry</a>, symk, k, l)));</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;          } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            result.<a class="code" href="classmolpro_1_1Operator__.html#a70901845f6938d7330cba6ddf2263a44">element</a>(k, symk, l, syml, <span class="keyword">true</span>) +=</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                ((density.<a class="code" href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">O1</a>(<span class="keyword">true</span>)) &amp; (*O2(<span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>).smat(result.<a class="code" href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">m_symmetry</a>, symk, k, l)));</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> symi = 0; symi &lt; 8; symi++) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_dimensions[0][0][symi]; i++) { <span class="comment">// N^5. If it matters, this could be speeded up.</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;              <span class="keywordflow">if</span> (result.<a class="code" href="classmolpro_1_1Operator__.html#addb215888a5251d81aba6db8f9926b3f">m_uhf</a>) {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                result.<a class="code" href="classmolpro_1_1Operator__.html#a70901845f6938d7330cba6ddf2263a44">element</a>(k, symk, l, syml, <span class="keyword">true</span>) -=</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                    (*O2(<span class="keyword">true</span>, <span class="keyword">true</span>).smat(symi ^ symk, symi, i, k) * density.<a class="code" href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">O1</a>(<span class="keyword">true</span>)).blockMap(syml)(l, i);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                result.<a class="code" href="classmolpro_1_1Operator__.html#a70901845f6938d7330cba6ddf2263a44">element</a>(k, symk, l, syml, <span class="keyword">false</span>) -=</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                    (*O2(<span class="keyword">false</span>, <span class="keyword">false</span>).smat(symi ^ symk, symi, i, k) * density.<a class="code" href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">O1</a>(<span class="keyword">false</span>)).blockMap(syml)(l, i);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;              } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                result.<a class="code" href="classmolpro_1_1Operator__.html#a70901845f6938d7330cba6ddf2263a44">element</a>(k, symk, l, syml, <span class="keyword">true</span>) -=</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                    0.5 * (*O2(<span class="keyword">true</span>, <span class="keyword">true</span>).smat(symi ^ symk, symi, i, k) * density.<a class="code" href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">O1</a>(<span class="keyword">true</span>)).blockMap(syml)(l, i);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;          }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">throw</span> std::logic_error(<span class="stringliteral">&quot;Unimplemented fock of 2-particle density&quot;</span>);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;}</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a1d2d5660ff702b36c528629ab5aaee76">  664</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; molpro::bytestream <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;::bytestream</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keyword">class </span>molpro::bytestream bs;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> spin = 0; spin &lt; 2; spin++)</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      bs.append(&amp;m_dimensions[spin][i][0], m_dimensions[spin][i].size());</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  bs.append(m_rank);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  bs.append(m_uhf);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  bs.append(&amp;m_hermiticity[0], 2);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  bs.append(&amp;m_exchange[0], 2);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  bs.append(m_symmetry);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  bs.append(m_covariant ? 1 : 0);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  bs.append(&amp;m_description[0], m_description.size());</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  bs.append(m_dirac_out_of_date);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  bs.append(&amp;m_O0, 1);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="keywordflow">if</span> (m_rank &gt; 0)</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    bs.append(m_O1a-&gt;bytestream());</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keywordflow">if</span> (m_rank &gt; 0 &amp;&amp; m_uhf)</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    bs.append(m_O1b-&gt;bytestream());</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keywordflow">if</span> (m_rank &gt; 1)</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    bs.append(m_O2aa_mulliken-&gt;bytestream());</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keywordflow">if</span> (m_rank &gt; 1 &amp;&amp; m_uhf)</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    bs.append(m_O2ab_mulliken-&gt;bytestream());</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="keywordflow">if</span> (m_rank &gt; 1 &amp;&amp; m_uhf)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    bs.append(m_O2bb_mulliken-&gt;bytestream());</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="keywordflow">if</span> (m_rank &gt; 1 &amp;&amp; !m_dirac_out_of_date)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    bs.append(m_O2aa_dirac-&gt;<a class="code" href="classmolpro_1_1SMat__.html#a957ab00af39f9506b9115df9cfacc561">bytestream</a>());</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="keywordflow">if</span> (m_rank &gt; 1 &amp;&amp; m_uhf &amp;&amp; !m_dirac_out_of_date)</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    bs.append(m_O2ab_dirac-&gt;bytestream());</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="keywordflow">if</span> (m_rank &gt; 1 &amp;&amp; m_uhf &amp;&amp; !m_dirac_out_of_date)</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    bs.append(m_O2bb_dirac-&gt;bytestream());</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="keywordflow">return</span> bs;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;}</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; </div>
<div class="line"><a name="l00697"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a1b8666aedb49899b0176cef3fe5d94ec">  697</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classmolpro_1_1Operator__.html#a1b8666aedb49899b0176cef3fe5d94ec">Operator_&lt;T&gt;::zero</a>() {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  m_O0 = 0;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  m_O1a-&gt;data()-&gt;assign(0);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="keywordflow">if</span> (m_rank &gt; 1)</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    m_O2aa_mulliken-&gt;data()-&gt;assign(0);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="keywordflow">if</span> (m_uhf) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    m_O1b-&gt;data()-&gt;assign(0);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">if</span> (m_rank &gt; 1)</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      m_O2ab_mulliken-&gt;data()-&gt;assign(0);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordflow">if</span> (m_rank &gt; 1)</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      m_O2bb_mulliken-&gt;data()-&gt;assign(0);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  m_dirac_out_of_date = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  ensure_dirac();</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;}</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a2c884131888790d27bcf65f6001afda5">  713</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classmolpro_1_1Operator__.html#a2c884131888790d27bcf65f6001afda5">Operator_&lt;T&gt;::set_dirty</a>()<span class="keyword"> const </span>{ m_dirac_out_of_date = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a92a18303329a4a9a8f1aedc1c20435dc">  715</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;</a>&amp; <a class="code" href="classmolpro_1_1Operator__.html#a92a18303329a4a9a8f1aedc1c20435dc">Operator_&lt;T&gt;::operator-=</a>(<span class="keyword">const</span> <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;</a>&amp; other) {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  checkCompatible(other);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="keywordflow">if</span> (other.<a class="code" href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">m_rank</a> &gt; m_rank)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">throw</span> std::logic_error(<span class="stringliteral">&quot;Incompatible operator ranks&quot;</span>);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  m_O0 -= other.<a class="code" href="classmolpro_1_1Operator__.html#a16bf7f125cb7fbf5e26d5102d3311483">m_O0</a>;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  *m_O1a -= *other.<a class="code" href="classmolpro_1_1Operator__.html#a468d6e8eb978198531c2c90776f9ebaa">m_O1a</a>;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="keywordflow">if</span> (other.<a class="code" href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">m_rank</a> &gt; 1)</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    *m_O2aa_mulliken -= *other.<a class="code" href="classmolpro_1_1Operator__.html#ada91d58116a902824c0db68affb93c53">m_O2aa_mulliken</a>;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordflow">if</span> (m_uhf) {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    *m_O1b -= *other.<a class="code" href="classmolpro_1_1Operator__.html#aa19f592a7a1eb89168d50f8e92b85160">m_O1b</a>;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordflow">if</span> (other.<a class="code" href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">m_rank</a> &gt; 1)</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      *m_O2ab_mulliken -= *other.<a class="code" href="classmolpro_1_1Operator__.html#ac507cb97c4b761359154c2cafc71038f">m_O2ab_mulliken</a>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordflow">if</span> (other.<a class="code" href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">m_rank</a> &gt; 1)</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      *m_O2bb_mulliken -= *other.<a class="code" href="classmolpro_1_1Operator__.html#a036e2e9bc406cf44c59af8a6580898b7">m_O2bb_mulliken</a>;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  m_dirac_out_of_date = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;}</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a6179fc8618d97b316f340239f8cee816">  734</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;</a>&amp; <a class="code" href="classmolpro_1_1Operator__.html#a6179fc8618d97b316f340239f8cee816">Operator_&lt;T&gt;::operator+=</a>(<span class="keyword">const</span> <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;</a>&amp; other) {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  checkCompatible(other);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordflow">if</span> (other.<a class="code" href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">m_rank</a> &gt; m_rank)</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">throw</span> std::logic_error(<span class="stringliteral">&quot;Incompatible operator ranks&quot;</span>);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  m_O0 += other.<a class="code" href="classmolpro_1_1Operator__.html#a16bf7f125cb7fbf5e26d5102d3311483">m_O0</a>;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  *m_O1a += *other.<a class="code" href="classmolpro_1_1Operator__.html#a468d6e8eb978198531c2c90776f9ebaa">m_O1a</a>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordflow">if</span> (other.<a class="code" href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">m_rank</a> &gt; 1)</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    *m_O2aa_mulliken += *other.<a class="code" href="classmolpro_1_1Operator__.html#ada91d58116a902824c0db68affb93c53">m_O2aa_mulliken</a>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="keywordflow">if</span> (m_uhf) {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    *m_O1b += *other.<a class="code" href="classmolpro_1_1Operator__.html#aa19f592a7a1eb89168d50f8e92b85160">m_O1b</a>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordflow">if</span> (other.<a class="code" href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">m_rank</a> &gt; 1)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      *m_O2ab_mulliken += *other.<a class="code" href="classmolpro_1_1Operator__.html#ac507cb97c4b761359154c2cafc71038f">m_O2ab_mulliken</a>;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordflow">if</span> (other.<a class="code" href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">m_rank</a> &gt; 1)</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      *m_O2bb_mulliken += *other.<a class="code" href="classmolpro_1_1Operator__.html#a036e2e9bc406cf44c59af8a6580898b7">m_O2bb_mulliken</a>;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  m_dirac_out_of_date = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;}</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#ab93c4112118146afd29556550d07467f">  753</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;</a>&amp; <a class="code" href="classmolpro_1_1Operator__.html#ab93c4112118146afd29556550d07467f">Operator_&lt;T&gt;::operator*=</a>(<a class="code" href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a> other) {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  m_O0 *= other;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  *m_O1a *= other;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keywordflow">if</span> (m_rank &gt; 1)</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    *m_O2aa_mulliken *= other;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="keywordflow">if</span> (m_uhf) {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    *m_O1b *= other;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">if</span> (m_rank &gt; 1)</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      *m_O2ab_mulliken *= other;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">if</span> (m_rank &gt; 1)</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      *m_O2bb_mulliken *= other;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  m_dirac_out_of_date = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;}</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div>
<div class="line"><a name="l00769"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#a87ab2b8812f1233c41f57fcd5ffc4265">  769</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">typename</span> <a class="code" href="classmolpro_1_1SMat__.html#a8b8c1114d47d84f7d7ed2924fe11ed23">SMat_&lt;T&gt;::scalar_type</a> <a class="code" href="classmolpro_1_1Operator__.html#a87ab2b8812f1233c41f57fcd5ffc4265">Operator_&lt;T&gt;::operator&amp;</a>(<span class="keyword">const</span> <a class="code" href="classmolpro_1_1Operator__.html">Operator_&lt;T&gt;</a>&amp; other)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="keywordflow">if</span> (other.<a class="code" href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">m_rank</a> != m_rank)</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordflow">throw</span> std::logic_error(<span class="stringliteral">&quot;Incompatible operator ranks&quot;</span>);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <a class="code" href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a> result = m_O0 * other.<a class="code" href="classmolpro_1_1Operator__.html#a16bf7f125cb7fbf5e26d5102d3311483">m_O0</a>;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <span class="comment">//  std::cout &lt;&lt; &quot;@@ Operator_&lt;T&gt;::operator&amp;&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="comment">//  std::cout &lt;&lt; &quot;1a: &quot; &lt;&lt;this-&gt;O1(true).data()[0]&lt;&lt;other.O1(true).data()[0]&lt;&lt;(this-&gt;O1(true) &amp;</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="comment">//  other.O1(true))&lt;&lt;std::endl; std::cout &lt;&lt; &quot;1b: &quot;</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="comment">//  &lt;&lt;this-&gt;O1(true).data()[0]&lt;&lt;other.O1(true).data()[0]&lt;&lt;(this-&gt;O1(false) &amp; other.O1(false))&lt;&lt;std::endl; std::cout &lt;&lt;</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="comment">//  &quot;2aa: &quot; &lt;&lt;this-&gt;O2(true,true).data()[0]&lt;&lt;other.O2(true,true).data()[0]&lt;&lt;</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="comment">//          (this-&gt;O2(true,true) &amp; other.O2(true,true))&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="comment">//  std::cout &lt;&lt; &quot;2ab: &quot; &lt;&lt;this-&gt;O2(true,false).data()[0]&lt;&lt;other.O2(true,false).data()[0]&lt;&lt;</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="comment">//          (this-&gt;O2(true,false) &amp; other.O2(true,false))&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="comment">//  std::cout &lt;&lt; &quot;2bb: &quot; &lt;&lt;this-&gt;O2(false,false).data()[0]&lt;&lt;other.O2(false,false).data()[0]&lt;&lt;</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <span class="comment">//          (this-&gt;O2(false,false) &amp; other.O2(false,false))&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keywordflow">if</span> (m_uhf) {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordflow">if</span> (m_rank &gt; 0)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      result += (this-&gt;O1(<span class="keyword">true</span>) &amp; other.<a class="code" href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">O1</a>(<span class="keyword">true</span>)) + (this-&gt;O1(<span class="keyword">false</span>) &amp; other.<a class="code" href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">O1</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordflow">if</span> (m_rank &gt; 1)</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      result += (this-&gt;O2(<span class="keyword">true</span>, <span class="keyword">true</span>) &amp; other.<a class="code" href="classmolpro_1_1Operator__.html#a6dca1a22715063777629a87ded042396">O2</a>(<span class="keyword">true</span>, <span class="keyword">true</span>)) + <a class="code" href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a>(2) * (this-&gt;O2(<span class="keyword">true</span>, <span class="keyword">false</span>) &amp; other.<a class="code" href="classmolpro_1_1Operator__.html#a6dca1a22715063777629a87ded042396">O2</a>(<span class="keyword">true</span>, <span class="keyword">false</span>)) +</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                (this-&gt;O2(<span class="keyword">false</span>, <span class="keyword">false</span>) &amp; other.<a class="code" href="classmolpro_1_1Operator__.html#a6dca1a22715063777629a87ded042396">O2</a>(<span class="keyword">false</span>, <span class="keyword">false</span>));</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordflow">if</span> (m_rank &gt; 0)</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      result += <a class="code" href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a>(1) * (this-&gt;O1(<span class="keyword">true</span>) &amp; other.<a class="code" href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">O1</a>(<span class="keyword">true</span>));</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="comment">//      std::cout &lt;&lt; &quot;result after 1-elec &quot;&lt;&lt;result;</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="comment">//      std::cout &lt;&lt; this-&gt;O2(true,false).str( &quot;this-&gt;O2(true,false)&quot;,2)&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="comment">//      std::cout &lt;&lt; other.O2(true,false).str( &quot;other.O2(true,false)&quot;,2)&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordflow">if</span> (m_rank &gt; 1)</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      result += <a class="code" href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a>(0.5) * (this-&gt;O2(<span class="keyword">true</span>, <span class="keyword">false</span>) &amp; other.<a class="code" href="classmolpro_1_1Operator__.html#a6dca1a22715063777629a87ded042396">O2</a>(<span class="keyword">true</span>, <span class="keyword">false</span>));</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="comment">//      std::cout &lt;&lt; &quot;result after 2-elec &quot;&lt;&lt;result&lt;&lt;std::endl;;</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;}</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno"><a class="line" href="classmolpro_1_1Operator__.html#ab701242e04c76327c6d0a88aaf4b3859">  809</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <a class="code" href="classmolpro_1_1SMat__.html">SMat_&lt;T&gt;</a> <a class="code" href="classmolpro_1_1Operator__.html#ab701242e04c76327c6d0a88aaf4b3859">Operator_&lt;T&gt;::metric</a>() {</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="comment">// FIXME some policing of restrictions</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <a class="code" href="namespacemolpro.html#a67177c2ad49feab84008cc04c3bb1f7c">dim_t</a> pqlen;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; Gamma = O2(<span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="comment">//  std::cout &lt;&lt; &quot;Gamma\n&quot;&lt;&lt;Gamma&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; gamma = O1(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="comment">//  std::cout &lt;&lt; &quot;gamma\n&quot;&lt;&lt;gamma&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> pqsym = 0; pqsym &lt; 8; pqsym++)</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    pqlen.emplace_back(Gamma.block_size(pqsym));</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="comment">//  for (auto pqsym=0; pqsym&lt;8; pqsym++) {</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="comment">//    std::cout &lt;&lt; &quot;2pdm ab block\n&quot; &lt;&lt;Gamma.blockM(pqsym)&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="comment">//    }</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="comment">//  std::cout &lt;&lt; &quot;metric: this\n&quot;&lt;&lt;*this&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="comment">//  std::cout &lt;&lt;&quot;metric dimensions:&quot;;for (auto&amp;p : pqlen) std::cout &lt;&lt; &quot; &quot;&lt;&lt;p; std::cout &lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <a class="code" href="classmolpro_1_1SMat__.html">SMat_&lt;T&gt;</a> result(<a class="code" href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">dims_t</a>{pqlen, pqlen}, <a class="code" href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fab84d144528f1a54d906ec2d9922f3aec">parityNone</a>, 0, <span class="keyword">false</span>, m_description + <span class="stringliteral">&quot; metric&quot;</span>);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> pqsym = 0; pqsym &lt; 8; pqsym++) {</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    std::copy(Gamma.block(pqsym).begin(), Gamma.block(pqsym).end(), result.block(pqsym).begin());</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordtype">size_t</span> offset = 0;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> psym = 0; psym &lt; 8; psym++) {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> qsym = psym ^ pqsym;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> p = 0; p &lt; m_dimensions[0][0][psym]; p++)</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> q = 0; q &lt; m_dimensions[0][0][qsym]; q++)</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rsym = 0; rsym &lt; 8; rsym++) {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ssym = rsym ^ pqsym;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> r = 0; r &lt; m_dimensions[0][0][rsym]; r++)</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> s = 0; s &lt; m_dimensions[0][0][ssym]; s++) {</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                result.block(pqsym)[offset] = Gamma.smat(pqsym, qsym, p, q)-&gt;blockMap(rsym)(r, s);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                <span class="comment">//                        if (rsym==psym &amp;&amp; r==p) result.block(pqsym)[offset] +=</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                <span class="comment">//                        gamma.blockMap(qsym)(q,s);</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                <span class="keywordflow">if</span> (ssym == qsym &amp;&amp; s == q)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                  result.block(pqsym)[offset] += gamma.blockMap(psym)(p, r);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                <span class="keywordflow">if</span> (p == q &amp;&amp; psym == qsym)</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                  result.block(pqsym)[offset] = 0;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                <span class="keywordflow">if</span> (r == s &amp;&amp; rsym == ssym)</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                  result.block(pqsym)[offset] = 0;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                <span class="comment">//                        std::cout &lt;&lt; &quot;p=&quot;&lt;&lt;p+1&lt;&lt;&quot;,q=&quot;&lt;&lt;q+1&lt;&lt;&quot;,r=&quot;&lt;&lt;r+1&lt;&lt;&quot;,s=&quot;&lt;&lt;s+1&lt;&lt;&quot;,</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                <span class="comment">//                        Gamma(q,p,r,s)=&quot;&lt;&lt;</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                <span class="comment">//                        Gamma.smat(pqsym,qsym,q,p)-&gt;blockMap(rsym)(r,s)&lt;&lt;&quot;=&quot;&lt;&lt;element(q,qsym,p,psym,r,rsym,s,ssym,true,false)&lt;&lt;&quot;,</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                <span class="comment">//                        S=&quot;&lt;&lt;result.block(pqsym)[offset]&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                ++offset;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;              }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;          }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    }</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="comment">//  std::cout &lt;&lt;&quot;constructed\n&quot;&lt;&lt;result&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;}</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// SYMMETRY_MATRIX_OPERATOR_IMPLEMENTATION_H</span></div>
<div class="ttc" id="aOperator-double_8cpp_html_a6b2d038ea9c8d2651eecffe0e28b7ebb"><div class="ttname"><a href="Operator-double_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a></div><div class="ttdeci">double T</div><div class="ttdef"><b>Definition:</b> Operator-double.cpp:9</div></div>
<div class="ttc" id="aOperator-implementation_8h_html_a16b1d5bff65e7d8d50aca34740df0dd9"><div class="ttname"><a href="Operator-implementation_8h.html#a16b1d5bff65e7d8d50aca34740df0dd9">parity</a></div><div class="ttdeci">parity_t parity(int hermiticity, parity_t odd=parityOddPacked)</div><div class="ttdef"><b>Definition:</b> Operator-implementation.h:8</div></div>
<div class="ttc" id="aOperator_8h_html"><div class="ttname"><a href="Operator_8h.html">Operator.h</a></div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html"><div class="ttname"><a href="classmolpro_1_1Operator__.html">molpro::Operator_</a></div><div class="ttdoc">Container for a quantum-mechanical operator (including density matrix) described by zero-,...</div><div class="ttdef"><b>Definition:</b> Operator.h:54</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_a036e2e9bc406cf44c59af8a6580898b7"><div class="ttname"><a href="classmolpro_1_1Operator__.html#a036e2e9bc406cf44c59af8a6580898b7">molpro::Operator_::m_O2bb_mulliken</a></div><div class="ttdeci">std::shared_ptr&lt; SMatMat &gt; m_O2bb_mulliken</div><div class="ttdef"><b>Definition:</b> Operator.h:331</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_a0ce4e4cf159d614704523aecf94e70d4"><div class="ttname"><a href="classmolpro_1_1Operator__.html#a0ce4e4cf159d614704523aecf94e70d4">molpro::Operator_::m_description</a></div><div class="ttdeci">std::string m_description</div><div class="ttdoc">A string describing the object.</div><div class="ttdef"><b>Definition:</b> Operator.h:324</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_a16bf7f125cb7fbf5e26d5102d3311483"><div class="ttname"><a href="classmolpro_1_1Operator__.html#a16bf7f125cb7fbf5e26d5102d3311483">molpro::Operator_::m_O0</a></div><div class="ttdeci">value_type m_O0</div><div class="ttdoc">The constant part of the operator.</div><div class="ttdef"><b>Definition:</b> Operator.h:325</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_a1b8666aedb49899b0176cef3fe5d94ec"><div class="ttname"><a href="classmolpro_1_1Operator__.html#a1b8666aedb49899b0176cef3fe5d94ec">molpro::Operator_::zero</a></div><div class="ttdeci">void zero()</div><div class="ttdef"><b>Definition:</b> Operator-implementation.h:697</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_a27ae8bd941dc27e01dc7942ee1944610"><div class="ttname"><a href="classmolpro_1_1Operator__.html#a27ae8bd941dc27e01dc7942ee1944610">molpro::Operator_::m_diagonal</a></div><div class="ttdeci">const bool m_diagonal</div><div class="ttdoc">Whether the representation of the operator is diagonal (1-electron only)</div><div class="ttdef"><b>Definition:</b> Operator.h:328</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_a2c884131888790d27bcf65f6001afda5"><div class="ttname"><a href="classmolpro_1_1Operator__.html#a2c884131888790d27bcf65f6001afda5">molpro::Operator_::set_dirty</a></div><div class="ttdeci">void set_dirty() const</div><div class="ttdoc">Marks Dirac integrals as out of date.</div><div class="ttdef"><b>Definition:</b> Operator-implementation.h:713</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_a420f17fcb448c0596d357cb6b5e850bb"><div class="ttname"><a href="classmolpro_1_1Operator__.html#a420f17fcb448c0596d357cb6b5e850bb">molpro::Operator_::construct</a></div><div class="ttdeci">static class Operator_ construct(const char *dump)</div><div class="ttdoc">Construct an object from what is produced by bytestream(). If the bytestream contains data,...</div><div class="ttdef"><b>Definition:</b> Operator-implementation.h:141</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_a468d6e8eb978198531c2c90776f9ebaa"><div class="ttname"><a href="classmolpro_1_1Operator__.html#a468d6e8eb978198531c2c90776f9ebaa">molpro::Operator_::m_O1a</a></div><div class="ttdeci">std::shared_ptr&lt; SMat &gt; m_O1a</div><div class="ttdef"><b>Definition:</b> Operator.h:330</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_a4a1560a5764ad1454f9557ff369372b5"><div class="ttname"><a href="classmolpro_1_1Operator__.html#a4a1560a5764ad1454f9557ff369372b5">molpro::Operator_::m_O2aa_dirac</a></div><div class="ttdeci">std::shared_ptr&lt; SMatMat &gt; m_O2aa_dirac</div><div class="ttdef"><b>Definition:</b> Operator.h:332</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_a56ee0078a62b241588913b717ca60178"><div class="ttname"><a href="classmolpro_1_1Operator__.html#a56ee0078a62b241588913b717ca60178">molpro::Operator_::m_hermiticity</a></div><div class="ttdeci">const std::vector&lt; int &gt; m_hermiticity</div><div class="ttdef"><b>Definition:</b> Operator.h:317</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_a6179fc8618d97b316f340239f8cee816"><div class="ttname"><a href="classmolpro_1_1Operator__.html#a6179fc8618d97b316f340239f8cee816">molpro::Operator_::operator+=</a></div><div class="ttdeci">class Operator_ &amp; operator+=(const class Operator_ &amp;other)</div><div class="ttdef"><b>Definition:</b> Operator-implementation.h:734</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_a6dca1a22715063777629a87ded042396"><div class="ttname"><a href="classmolpro_1_1Operator__.html#a6dca1a22715063777629a87ded042396">molpro::Operator_::O2</a></div><div class="ttdeci">const SMatMat &amp; O2(bool spinUp1=true, bool spinUp2=true, bool mulliken=true, bool ensure=true) const</div><div class="ttdoc">Obtain a read-only reference to 2-particle matrix elements.</div><div class="ttdef"><b>Definition:</b> Operator-implementation.h:480</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_a70901845f6938d7330cba6ddf2263a44"><div class="ttname"><a href="classmolpro_1_1Operator__.html#a70901845f6938d7330cba6ddf2263a44">molpro::Operator_::element</a></div><div class="ttdeci">const value_type &amp; element(int i, int isym, int j, int jsym, int k, int ksym, int l, int lsym, bool spinUp1=true, bool spinUp2=true, bool mulliken=true) const</div><div class="ttdoc">Get a reference to a single matrix element.</div><div class="ttdef"><b>Definition:</b> Operator-implementation.h:507</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_a87ab2b8812f1233c41f57fcd5ffc4265"><div class="ttname"><a href="classmolpro_1_1Operator__.html#a87ab2b8812f1233c41f57fcd5ffc4265">molpro::Operator_::operator&amp;</a></div><div class="ttdeci">scalar_type operator&amp;(const class Operator_ &amp;other) const</div><div class="ttdef"><b>Definition:</b> Operator-implementation.h:769</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_a92a18303329a4a9a8f1aedc1c20435dc"><div class="ttname"><a href="classmolpro_1_1Operator__.html#a92a18303329a4a9a8f1aedc1c20435dc">molpro::Operator_::operator-=</a></div><div class="ttdeci">class Operator_ &amp; operator-=(const class Operator_ &amp;other)</div><div class="ttdef"><b>Definition:</b> Operator-implementation.h:715</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_aa1233fe514f2df7e486ff86afc8ac0a7"><div class="ttname"><a href="classmolpro_1_1Operator__.html#aa1233fe514f2df7e486ff86afc8ac0a7">molpro::Operator_::m_O2bb_dirac</a></div><div class="ttdeci">std::shared_ptr&lt; SMatMat &gt; m_O2bb_dirac</div><div class="ttdef"><b>Definition:</b> Operator.h:332</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_aa19f592a7a1eb89168d50f8e92b85160"><div class="ttname"><a href="classmolpro_1_1Operator__.html#aa19f592a7a1eb89168d50f8e92b85160">molpro::Operator_::m_O1b</a></div><div class="ttdeci">std::shared_ptr&lt; SMat &gt; m_O1b</div><div class="ttdef"><b>Definition:</b> Operator.h:330</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_aac42e52c476f29ff1179fd9be789111f"><div class="ttname"><a href="classmolpro_1_1Operator__.html#aac42e52c476f29ff1179fd9be789111f">molpro::Operator_::m_O2ab_dirac</a></div><div class="ttdeci">std::shared_ptr&lt; SMatMat &gt; m_O2ab_dirac</div><div class="ttdef"><b>Definition:</b> Operator.h:332</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_aaccc9d30faf9c4983019259137448f42"><div class="ttname"><a href="classmolpro_1_1Operator__.html#aaccc9d30faf9c4983019259137448f42">molpro::Operator_::m_dirac_out_of_date</a></div><div class="ttdeci">bool m_dirac_out_of_date</div><div class="ttdef"><b>Definition:</b> Operator.h:333</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_ab1be924f24f25900aad356f0309d9f1a"><div class="ttname"><a href="classmolpro_1_1Operator__.html#ab1be924f24f25900aad356f0309d9f1a">molpro::Operator_::m_exchange</a></div><div class="ttdeci">const std::vector&lt; int &gt; m_exchange</div><div class="ttdef"><b>Definition:</b> Operator.h:319</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_ab273295fddb11078d804f227af7a512d"><div class="ttname"><a href="classmolpro_1_1Operator__.html#ab273295fddb11078d804f227af7a512d">molpro::Operator_::m_O2ba_mulliken</a></div><div class="ttdeci">std::shared_ptr&lt; SMatMat &gt; m_O2ba_mulliken</div><div class="ttdef"><b>Definition:</b> Operator.h:331</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_ab701242e04c76327c6d0a88aaf4b3859"><div class="ttname"><a href="classmolpro_1_1Operator__.html#ab701242e04c76327c6d0a88aaf4b3859">molpro::Operator_::metric</a></div><div class="ttdeci">SMat metric()</div><div class="ttdoc">Construct M(pq,rs)=this.mulliken(q,p,r,s)+delta(p,r)*this(q,s). The composite indices pq,...</div><div class="ttdef"><b>Definition:</b> Operator-implementation.h:809</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_ab79af3384f9ddd70a9f08f82267b6f65"><div class="ttname"><a href="classmolpro_1_1Operator__.html#ab79af3384f9ddd70a9f08f82267b6f65">molpro::Operator_::m_symmetry</a></div><div class="ttdeci">const unsigned int m_symmetry</div><div class="ttdoc">The spatial symmetry of the operator.</div><div class="ttdef"><b>Definition:</b> Operator.h:323</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_ab93c4112118146afd29556550d07467f"><div class="ttname"><a href="classmolpro_1_1Operator__.html#ab93c4112118146afd29556550d07467f">molpro::Operator_::operator*=</a></div><div class="ttdeci">class Operator_ &amp; operator*=(value_type other)</div><div class="ttdef"><b>Definition:</b> Operator-implementation.h:753</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_abfedd4ed0bb060f4f6ae467efb928dac"><div class="ttname"><a href="classmolpro_1_1Operator__.html#abfedd4ed0bb060f4f6ae467efb928dac">molpro::Operator_::m_O2ba_dirac</a></div><div class="ttdeci">std::shared_ptr&lt; SMatMat &gt; m_O2ba_dirac</div><div class="ttdef"><b>Definition:</b> Operator.h:332</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_ac507cb97c4b761359154c2cafc71038f"><div class="ttname"><a href="classmolpro_1_1Operator__.html#ac507cb97c4b761359154c2cafc71038f">molpro::Operator_::m_O2ab_mulliken</a></div><div class="ttdeci">std::shared_ptr&lt; SMatMat &gt; m_O2ab_mulliken</div><div class="ttdef"><b>Definition:</b> Operator.h:331</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_ad2b850d157e7af62771a089e415d20a6"><div class="ttname"><a href="classmolpro_1_1Operator__.html#ad2b850d157e7af62771a089e415d20a6">molpro::Operator_::m_rank</a></div><div class="ttdeci">const int m_rank</div><div class="ttdef"><b>Definition:</b> Operator.h:315</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_ad34403a5cf7a4cd77944d1f5e54bda13"><div class="ttname"><a href="classmolpro_1_1Operator__.html#ad34403a5cf7a4cd77944d1f5e54bda13">molpro::Operator_::str</a></div><div class="ttdeci">std::string str(std::string title=&quot;&quot;, int level=1) const</div><div class="ttdoc">Generate a printable summary of the object.</div><div class="ttdef"><b>Definition:</b> Operator-implementation.h:573</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_ad7405980136ba27e76d96d4ef9046a88"><div class="ttname"><a href="classmolpro_1_1Operator__.html#ad7405980136ba27e76d96d4ef9046a88">molpro::Operator_::Operator_</a></div><div class="ttdeci">Operator_(std::array&lt; dims_t, 2 &gt; dimensions, int rank=2, bool uhf=false, std::vector&lt; int &gt; hermiticity={1, 1}, std::vector&lt; int &gt; exchange={-1, -1}, unsigned int symmetry=0, bool covariant=true, bool diagonal=false, std::string description=&quot;&quot;)</div><div class="ttdoc">Construct an operator from its symmetry-block dimensions.</div><div class="ttdef"><b>Definition:</b> Operator-implementation.h:17</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_ada91d58116a902824c0db68affb93c53"><div class="ttname"><a href="classmolpro_1_1Operator__.html#ada91d58116a902824c0db68affb93c53">molpro::Operator_::m_O2aa_mulliken</a></div><div class="ttdeci">std::shared_ptr&lt; SMatMat &gt; m_O2aa_mulliken</div><div class="ttdef"><b>Definition:</b> Operator.h:331</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_addb215888a5251d81aba6db8f9926b3f"><div class="ttname"><a href="classmolpro_1_1Operator__.html#addb215888a5251d81aba6db8f9926b3f">molpro::Operator_::m_uhf</a></div><div class="ttdeci">const bool m_uhf</div><div class="ttdoc">the rank of the operator</div><div class="ttdef"><b>Definition:</b> Operator.h:316</div></div>
<div class="ttc" id="aclassmolpro_1_1Operator___html_aec38276794abf3d4582e8865ee7e49aa"><div class="ttname"><a href="classmolpro_1_1Operator__.html#aec38276794abf3d4582e8865ee7e49aa">molpro::Operator_::O1</a></div><div class="ttdeci">const SMat &amp; O1(bool spinUp=true) const</div><div class="ttdoc">Obtain a reference to 1-particle matrix elements.</div><div class="ttdef"><b>Definition:</b> Operator-implementation.h:473</div></div>
<div class="ttc" id="aclassmolpro_1_1SMatMat___html"><div class="ttname"><a href="classmolpro_1_1SMatMat__.html">molpro::SMatMat_</a></div><div class="ttdoc">Class that contains a matrix of matrices.</div><div class="ttdef"><b>Definition:</b> SMatMat.h:31</div></div>
<div class="ttc" id="aclassmolpro_1_1SMat___html"><div class="ttname"><a href="classmolpro_1_1SMat__.html">molpro::SMat_</a></div><div class="ttdoc">The SMat class holds the meta-information and a pointer to data for a symmetry-packed matrix object....</div><div class="ttdef"><b>Definition:</b> SMat.h:77</div></div>
<div class="ttc" id="aclassmolpro_1_1SMat___html_a8b8c1114d47d84f7d7ed2924fe11ed23"><div class="ttname"><a href="classmolpro_1_1SMat__.html#a8b8c1114d47d84f7d7ed2924fe11ed23">molpro::SMat_::scalar_type</a></div><div class="ttdeci">T scalar_type</div><div class="ttdef"><b>Definition:</b> SMat.h:90</div></div>
<div class="ttc" id="aclassmolpro_1_1SMat___html_a957ab00af39f9506b9115df9cfacc561"><div class="ttname"><a href="classmolpro_1_1SMat__.html#a957ab00af39f9506b9115df9cfacc561">molpro::SMat_::bytestream</a></div><div class="ttdeci">class molpro::bytestream bytestream(bool data=true)</div><div class="ttdoc">Serialise the object to a stream of bytes.</div></div>
<div class="ttc" id="anamespacemolpro_html"><div class="ttname"><a href="namespacemolpro.html">molpro</a></div><div class="ttdef"><b>Definition:</b> gciState.h:11</div></div>
<div class="ttc" id="anamespacemolpro_html_a67177c2ad49feab84008cc04c3bb1f7c"><div class="ttname"><a href="namespacemolpro.html#a67177c2ad49feab84008cc04c3bb1f7c">molpro::dim_t</a></div><div class="ttdeci">std::vector&lt; size_t &gt; dim_t</div><div class="ttdoc">Dimension for each symmetry in one axis of an SMat.</div><div class="ttdef"><b>Definition:</b> SMat.h:21</div></div>
<div class="ttc" id="anamespacemolpro_html_a77b8d977180296c55c184036b65c5a6f"><div class="ttname"><a href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6f">molpro::parity_t</a></div><div class="ttdeci">parity_t</div><div class="ttdoc">Index transposition symmetry of the SMat.</div><div class="ttdef"><b>Definition:</b> SMat.h:30</div></div>
<div class="ttc" id="anamespacemolpro_html_a77b8d977180296c55c184036b65c5a6fa09ceea7356628ff7d1cbc1d0149544e7"><div class="ttname"><a href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fa09ceea7356628ff7d1cbc1d0149544e7">molpro::parityEven</a></div><div class="ttdeci">@ parityEven</div><div class="ttdoc">Symmetric.</div><div class="ttdef"><b>Definition:</b> SMat.h:32</div></div>
<div class="ttc" id="anamespacemolpro_html_a77b8d977180296c55c184036b65c5a6fa5d5c6a3594b6f312d3d19b349ca8d25e"><div class="ttname"><a href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fa5d5c6a3594b6f312d3d19b349ca8d25e">molpro::parityOdd</a></div><div class="ttdeci">@ parityOdd</div><div class="ttdoc">Antisymmetric, storage as for Symmetric.</div><div class="ttdef"><b>Definition:</b> SMat.h:33</div></div>
<div class="ttc" id="anamespacemolpro_html_a77b8d977180296c55c184036b65c5a6fab84d144528f1a54d906ec2d9922f3aec"><div class="ttname"><a href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fab84d144528f1a54d906ec2d9922f3aec">molpro::parityNone</a></div><div class="ttdeci">@ parityNone</div><div class="ttdoc">Unsymmetric.</div><div class="ttdef"><b>Definition:</b> SMat.h:31</div></div>
<div class="ttc" id="anamespacemolpro_html_a77b8d977180296c55c184036b65c5a6fadf9df807b4f5e704d4dd447772943798"><div class="ttname"><a href="namespacemolpro.html#a77b8d977180296c55c184036b65c5a6fadf9df807b4f5e704d4dd447772943798">molpro::parityOddPacked</a></div><div class="ttdeci">@ parityOddPacked</div><div class="ttdoc">Antisymmetric, diagonal elements not stored. Incompatible with Molpro matrices.</div><div class="ttdef"><b>Definition:</b> SMat.h:34</div></div>
<div class="ttc" id="anamespacemolpro_html_a7a136b7a21c942e40967ed5bab20ff2e"><div class="ttname"><a href="namespacemolpro.html#a7a136b7a21c942e40967ed5bab20ff2e">molpro::dims_t</a></div><div class="ttdeci">std::vector&lt; dim_t &gt; dims_t</div><div class="ttdoc">dims_t Dimensions for an entire SMat</div><div class="ttdef"><b>Definition:</b> SMat.h:25</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
